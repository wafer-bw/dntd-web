{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"m\"","webpack:///./src/types/index.ts","webpack:///./src/controllers/index.ts","webpack:///./src/index.ts","webpack:///./src/factories/index.ts","webpack:///./src/components/index.ts","webpack:///./src/models/index.ts","webpack:///./src/errors/index.ts","webpack:///./src/types/errors.ts","webpack:///./src/types/search.ts","webpack:///./src/types/testing.ts","webpack:///./src/types/syncer.ts","webpack:///./src/controllers/urlController.ts","webpack:///./src/controllers/entryController.ts","webpack:///./src/models/SearchModel.ts","webpack:///./src/controllers/journalController.ts","webpack:///./src/views/index.ts","webpack:///./src/views/shelfView.ts","webpack:///./src/components/googleComponent.ts","webpack:///./src/controllers/textController.ts","webpack:///./src/factories/tagFactory.ts","webpack:///./src/models/UrlModel.ts","webpack:///./src/models/TagModel.ts","webpack:///./src/models/EntryModel.ts","webpack:///./src/models/ShelfModel.ts","webpack:///./src/models/SyncerModel.ts","webpack:///./src/models/GoogleModel.ts","webpack:///./src/models/JournalModel.ts","webpack:///./src/models/LibraryModel.ts","webpack:///./src/models/ServiceWorkerModel.ts","webpack:///./src/errors/FriendlyError.ts","webpack:///./src/factories/shelfFactory.ts","webpack:///./src/factories/entryFactory.ts","webpack:///./src/controllers/caretController.ts","webpack:///./src/controllers/searchController.ts","webpack:///./src/controllers/googleController.ts","webpack:///./src/mocks/index.ts","webpack:///./src/mocks/Gapi.ts","webpack:///./src/controllers/syncerController.ts","webpack:///./src/controllers/libraryController.ts","webpack:///./src/components/composeComponent.ts","webpack:///./src/components/entriesComponent.ts","webpack:///./src/components/shelvesComponent.ts","webpack:///./src/components/refinesComponent.ts","webpack:///./src/components/journalsComponent.ts","webpack:///./src/components/syncStateComponent.ts","webpack:///./src/components/searchbarComponent.ts","webpack:///./src/components/addShelvesComponent.ts","webpack:///./src/components/breadcrumbComponent.ts","webpack:///./src/views/signinView.ts","webpack:///./src/views/libraryView.ts","webpack:///./src/views/journalView.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__export","require","__importDefault","this","mod","mithril_1","views_1","models_1","serviceWorkerModel","ServiceWorkerModel","googleModel","GoogleModel","syncerModel","SyncerModel","libraryModel","LibraryModel","urlModel","UrlModel","searchModel","SearchModel","root","document","getElementById","default","route","signinView","libraryView","shelfView","journalView","_1","SyncerError","constructor","errorMsg","friendlyMsg","needsReAuth","pause","super","payload","undefined","error","type","SyncerPayloadType","ERROR","SearchType","TestMode","SyncerResponseType","SyncerState","__1","getActiveShelf","id","shelfId","shelves","urlController","redirect","hash","getActiveJournal","journalId","shelf","journals","getBreadcrumbTrail","_a","_b","_c","breadcrumb","split","filter","crumb","length","trail","slice","join","title","parseInt","b","push","href","factories_1","tagPattern","entryController","save","entry","entryIdx","content","sync","force","saved","savedClean","textController","clean","tags","tagMatches","Map","tag","has","frq","set","getTags","syncerController","updateRow","journal","update","raw","safe","escape","tokens","text","token","trim","tokenize","matchesIter","matchAll","match","tagFactory","createTag","sort","a","index","getTagMatches","rendered","chars","splice","render","types_1","searchType","NONE","simpleRefines","complexRefines","barQuery","entryFactory","createBaseEntry","refinesQuery","keys","Set","vals","simpleKeys","Array","from","values","errors_1","addEntry","idx","createJournalEntry","buildTags","entries","reverse","flag","separator","val","searchController","buildRefines","journalController","moveEntry","fromIdx","toIdx","deleteEntry","loadEntries","keepJournal","forEach","loaded","unloadEntries","getRows","then","rows","catch","FriendlyError","message","finally","redraw","components_1","view","googleComponent","syncStateComponent","breadcrumbComponent","journalsComponent","controllers_1","gapiScriptSettings","async","defer","src","onload","isSignedIn","googleController","initGapi","signInOutButton","onclick","signOut","class","signIn","preambleMessage","unsafe","replace","toLowerCase","cleanTagString","str","endsWith","substring","cleanKey","cleanVal","renderedKey","renderedVal","TagModel","url","URL","window","location","hash_","DEMO","test","param","instanceOfTestMode","OFF","includes","BaseEntryModel","JournalEntryModel","entryId","ShelfModel","requestsCounter","requests","state","INITIALIZING","pushSyncerTask","worker","Promise","resolve","reject","postMessage","scope","clientId","user","auth","getAuthResponse","access_token","JournalModel","journalTitle","updateEntry","shelfIds","ids","localStorage","setItem","getItem","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","e","rejected","result","done","apply","navigator","addEventListener","serviceWorker","register","console","warn","shelfFactory","createShelf","spreadsheetId","spreadsheet","properties","sheets","sheet","sheetId","getJournals","entryCounter","caretController","getCaretPosition","elem","sel","getSelection","cum_length","anchorNode","innerText","extentNode","nodes_to_find","contains","found","node_walk","node","func","firstChild","nextSibling","textContent","anchorOffset","extentOffset","setCaretPosition","el","pos","childNodes","nodeType","range","createRange","setStart","collapse","removeAllRanges","addRange","entryController_1","search","query","sourceEntries","filteredEntries","AND","every","OR","some","startsWith","reset","delete","cleanRefines","map","updateSearchbar","mocks_1","signedIn","gapi_","auth2","getAuthInstance","currentUser","updateAuth","libraryController","loadShelves","removeShelves","testMode","gapi","MockGapi","load","init","client_id","listen","MockAuth2","_api","_callback","MockGoogleAuth","_params","MockCurrentUser","MockGoogleUser","expires_in","MockIsSignedIn","Worker","AUTH_UPDATE","onmessage","msg","data","SYNC_STATE","TOKEN_REQUEST","onMessage","unpause","UNPAUSE","GET_ROWS","sheetTitle","deleteRow","DELETE_ROW","UPDATE_ROW","getSheets","GET_SHEETS","updateTestMode","TEST_MODE_UPDATE","getSpreadsheet","GET_SPREADSHEET","urlController_1","journalController_1","spreadsheetIdPattern","reloadLoaded","getSpreadsheetIdsFromUrls","urls","addShelves","composeComponent","caret","composePrefixEntry","composeContentEntry","composeSuffixEntry","prefixSettings","entrySettings","suffixSettings","composeNodeSettings","extraSettings","baseSettings","contenteditable","onkeydown","event","keyCode","shiftKey","preventDefault","els","getComposedContent","composeKeydown","oninput","target","composeInput","onupdate","assign","trust","entriesComponent","entriesList","entryContent","deleteEntryButton","entryVnode","blur","onEntryKeydown","onEntryInput","onEntryUpdate","onblur","onEntryBlur","entryContentSettings","shelvesComponent","delShelfButton","retryShelfLoadButton","shelfNode","refinesComponent","simpleTagsHeader","expanded","simpleRefinesVnodes","size","refineKeyVnode","refineValVnode","complexRefinesVnodes","count","metaKey","ctrlKey","add","refineTagKeyOnClick","tagRefineKeySettings","checked","tagRefineValSettings","tagClass","hideClass","refineTagValOnClick","link","journalList","syncStateText","txt","class_","stateColorClass","DOWNLOADING","PAUSED","SYNCED","UPLOADING","syncStateIcon","unpauseSync","searchbarComponent","searchNodeSettings","placeholder","onSearchInput","onSearchKeydown","clearSearchNodeSettings","addShelvesComponent","newShelfUrls","addingShelves","addShelvesButton","addShelvesTextbox","oninit"],"mappings":"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","file":"dntd.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","module.exports = m;","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./errors\"));\n__export(require(\"./search\"));\n__export(require(\"./testing\"));\n__export(require(\"./syncer\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./urlController\"));\n__export(require(\"./textController\"));\n__export(require(\"./entryController\"));\n__export(require(\"./caretController\"));\n__export(require(\"./searchController\"));\n__export(require(\"./googleController\"));\n__export(require(\"./syncerController\"));\n__export(require(\"./libraryController\"));\n__export(require(\"./journalController\"));\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst views_1 = require(\"./views\");\nconst models_1 = require(\"./models\");\nexports.serviceWorkerModel = new models_1.ServiceWorkerModel();\nexports.googleModel = new models_1.GoogleModel();\nexports.syncerModel = new models_1.SyncerModel();\nexports.libraryModel = new models_1.LibraryModel();\nexports.urlModel = new models_1.UrlModel();\nexports.searchModel = new models_1.SearchModel();\nconst root = document.getElementById(\"root\");\nif (root !== null) {\n    mithril_1.default.route(root, \"/\", {\n        \"/\": views_1.signinView,\n        \"/signin\": views_1.signinView,\n        \"/library\": views_1.libraryView,\n        \"/library/:shelfId\": views_1.shelfView,\n        \"/library/:shelfId/:journalId\": views_1.journalView,\n    });\n}\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./tagFactory\"));\n__export(require(\"./shelfFactory\"));\n__export(require(\"./entryFactory\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./googleComponent\"));\n__export(require(\"./composeComponent\"));\n__export(require(\"./entriesComponent\"));\n__export(require(\"./shelvesComponent\"));\n__export(require(\"./refinesComponent\"));\n__export(require(\"./journalsComponent\"));\n__export(require(\"./syncStateComponent\"));\n__export(require(\"./searchbarComponent\"));\n__export(require(\"./addShelvesComponent\"));\n__export(require(\"./breadcrumbComponent\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./UrlModel\"));\n__export(require(\"./TagModel\"));\n__export(require(\"./EntryModel\"));\n__export(require(\"./ShelfModel\"));\n__export(require(\"./SyncerModel\"));\n__export(require(\"./SearchModel\"));\n__export(require(\"./GoogleModel\"));\n__export(require(\"./SearchModel\"));\n__export(require(\"./JournalModel\"));\n__export(require(\"./LibraryModel\"));\n__export(require(\"./ServiceWorkerModel\"));\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./FriendlyError\"));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst _1 = require(\".\");\nclass SyncerError extends Error {\n    constructor(errorMsg, friendlyMsg, needsReAuth, pause) {\n        super(errorMsg);\n        this.friendlyMsg = friendlyMsg;\n        this.needsReAuth = needsReAuth;\n        this.payload = {\n            pause: (pause !== undefined) ? pause : true,\n            error: this,\n            friendlyMsg: this.friendlyMsg,\n            type: _1.SyncerPayloadType.ERROR,\n        };\n    }\n}\nexports.SyncerError = SyncerError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SearchType;\n(function (SearchType) {\n    SearchType[SearchType[\"NONE\"] = 0] = \"NONE\";\n    SearchType[SearchType[\"AND\"] = 1] = \"AND\";\n    SearchType[SearchType[\"OR\"] = 2] = \"OR\";\n})(SearchType = exports.SearchType || (exports.SearchType = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TestMode;\n(function (TestMode) {\n    TestMode[\"OFF\"] = \"0\";\n    TestMode[\"WORKING\"] = \"1\";\n    TestMode[\"FAIL_GET_SPREADSHEET_SHEETS\"] = \"2\";\n    TestMode[\"FAIL_GET_RANGE\"] = \"3\";\n    TestMode[\"FAIL_UPDATE_RANGE\"] = \"4\";\n    TestMode[\"FAIL_DELETE_ROW\"] = \"5\";\n    TestMode[\"RETURN_ROWS\"] = \"6\";\n    TestMode[\"DEMO\"] = \"7\";\n})(TestMode = exports.TestMode || (exports.TestMode = {}));\n","import { TestMode } from \"./testing\"\n\nexport type SyncerPayload = (\n    GetRowsPayload | GetSheetsPayload | GetSpreadsheetPayload | UpdateRowPayload |\n    ExtendSheetPayload | DeleteRowPayload | TestModeUpdatePayload | AuthUpdatePayload |\n    UnpausePayload | SyncStatePayload | ErrorPayload | TokenRequestPayload\n)\n\nexport enum SyncerPayloadType {\n    AUTH_UPDATE,\n    DELETE_ROW,\n    UPDATE_ROW,\n    GET_ROWS,\n    GET_SHEETS,\n    TEST_MODE_UPDATE,\n    UNPAUSE,\n    GET_SPREADSHEET,\n    EXTEND_SHEET,\n    CREATE_ROW,\n    MOVE_ROW,\n    ERROR,\n    TOKEN_REQUEST,\n    SYNC_STATE,\n}\n\nexport enum SyncerResponseType {\n    SYNCER_STATE,\n    ERROR,\n    REAUTH,\n}\n\nexport enum SyncerState {\n    PAUSED = \"cloud_off\",\n    UPLOADING = \"cloud_upload\",\n    DOWNLOADING = \"cloud_download\",\n    SYNCED = \"cloud_done\",\n    INITIALIZING = \"cloud_queue\",\n}\n\nexport interface TestModeUpdatePayload {\n    type: SyncerPayloadType.TEST_MODE_UPDATE\n    testMode: TestMode\n}\n\nexport interface AuthUpdatePayload {\n    type: SyncerPayloadType.AUTH_UPDATE\n    token: string\n}\n\nexport interface UnpausePayload {\n    type: SyncerPayloadType.UNPAUSE\n}\n\nexport interface DeleteRowPayload {\n    type: SyncerPayloadType.DELETE_ROW\n    idx: number\n    spreadsheetId: string\n    sheetId: number\n}\n\nexport interface ExtendSheetPayload {\n    type: SyncerPayloadType.EXTEND_SHEET\n    spreadsheetId: string\n    sheetId: number\n}\n\nexport interface UpdateRowPayload {\n    type: SyncerPayloadType.UPDATE_ROW\n    idx: number\n    spreadsheetId: string\n    sheetId: number\n    sheetTitle: string\n    content: string\n}\n\nexport interface GetSpreadsheetPayload {\n    type: SyncerPayloadType.GET_SPREADSHEET\n    spreadsheetId: string\n    spreadsheet?: gapi.client.sheets.Spreadsheet\n}\n\nexport interface GetRowsPayload {\n    type: SyncerPayloadType.GET_ROWS\n    spreadsheetId: string\n    sheetId: number\n    sheetTitle: string\n    rows: string[]\n}\n\nexport interface GetSheetsPayload {\n    type: SyncerPayloadType.GET_SHEETS\n    spreadsheetId: string\n    sheets: gapi.client.sheets.Sheet[]\n}\n\nexport interface SyncStatePayload {\n    type: SyncerPayloadType.SYNC_STATE\n    length: number\n    state: SyncerState\n}\n\nexport interface ErrorPayload {\n    type: SyncerPayloadType.ERROR\n    error: Error\n    pause: boolean\n    friendlyMsg: string\n}\n\nexport interface TokenRequestPayload {\n    type: SyncerPayloadType.TOKEN_REQUEST\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nexports.urlController = {\n    redirect: redirect,\n    getActiveShelf: getActiveShelf,\n    getActiveJournal: getActiveJournal,\n    getBreadcrumbTrail: getBreadcrumbTrail,\n};\nfunction redirect(hash) {\n    __1.urlModel.hash = hash;\n}\nfunction getActiveShelf() {\n    let id = __1.urlModel.shelfId;\n    if (id === undefined)\n        return undefined;\n    return __1.libraryModel.shelves.get(id);\n}\nfunction getActiveJournal() {\n    let id = __1.urlModel.journalId;\n    let shelf = getActiveShelf();\n    if (id === undefined || shelf === undefined)\n        return undefined;\n    return shelf.journals.get(id);\n}\nfunction getBreadcrumbTrail() {\n    var _a, _b, _c;\n    let breadcrumb = [];\n    let hash = __1.urlModel.hash.split(\"/\").filter(crumb => crumb !== \"#\" && crumb !== \"\");\n    let shelfId = undefined;\n    for (let i = 0; i < hash.length; i++) {\n        let crumb = hash[i];\n        let trail = \"#/\" + hash.slice(0, i + 1).join(\"/\");\n        if (i === 1) {\n            shelfId = crumb;\n            crumb = ((_a = __1.libraryModel.shelves.get(crumb)) === null || _a === void 0 ? void 0 : _a.title) || crumb;\n        }\n        else if (i === 2 && shelfId !== undefined) {\n            crumb = ((_c = (_b = __1.libraryModel.shelves.get(shelfId)) === null || _b === void 0 ? void 0 : _b.journals.get(parseInt(crumb))) === null || _c === void 0 ? void 0 : _c.title) || crumb;\n        }\n        if (i !== 0)\n            breadcrumb.push(mithril_1.default(\"span\", \" / \"));\n        if (i === hash.length - 1) {\n            breadcrumb.push(mithril_1.default(\"span\", `${crumb}`));\n        }\n        else {\n            breadcrumb.push(mithril_1.default(\"a\", { href: trail }, `${crumb}`));\n        }\n    }\n    return breadcrumb;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst factories_1 = require(\"../factories\");\nconst _1 = require(\".\");\nconst tagPattern = /(\\@)([\\w-']+)+(:)?([\\w-'\\*]+)?/g;\nexports.entryController = {\n    save: save,\n    update: update,\n};\nfunction save(entry, entryIdx, content, sync, force) {\n    if (entry.saved !== content || force) {\n        entry.saved = content;\n        entry.savedClean = _1.textController.clean(entry.saved);\n        entry.tags = getTags(entry.tagMatches);\n        if (sync) {\n            _1.syncerController.updateRow(entry.shelf.id, entry.journal.id, entry.journal.title, entryIdx, content);\n        }\n    }\n}\nfunction update(entry, content) {\n    entry.raw = content;\n    entry.clean = _1.textController.clean(content);\n    entry.safe = _1.textController.escape(entry.raw);\n    entry.tokens = tokenize(entry.clean);\n    entry.tagMatches = getTagMatches(entry.safe);\n    entry.rendered = render(entry.safe, entry.tagMatches);\n}\nfunction render(text, tagMatches) {\n    for (let { tag, match } of tagMatches) {\n        let chars = text.split(\"\");\n        chars.splice(match.index, match[0].length, tag.rendered);\n        text = chars.join(\"\");\n    }\n    return text;\n}\nfunction getTags(tagMatches) {\n    let tags = new Map();\n    for (let { tag } of tagMatches) {\n        if (tags.has(tag.clean)) {\n            tags.get(tag.clean).frq += 1;\n        }\n        else {\n            tags.set(tag.clean, tag);\n        }\n    }\n    return tags;\n}\nfunction getTagMatches(text) {\n    let tagMatches = [];\n    let matchesIter = text.matchAll(tagPattern);\n    for (let match of matchesIter) {\n        let tag = factories_1.tagFactory.createTag(match[0], match[1], match[2], match[3], match[4]);\n        tagMatches.push({ tag: tag, match: match });\n    }\n    tagMatches.sort((a, b) => (a.match.index > b.match.index) ? -1 : 1);\n    return tagMatches;\n}\nfunction tokenize(text) {\n    let tokens = text.split(\" \");\n    return tokens.filter(token => {\n        return token !== undefined && token.trim() !== \"\" && token !== \"-\";\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst types_1 = require(\"../types\");\nconst factories_1 = require(\"../factories\");\nclass SearchModel {\n    constructor() {\n        this.searchType = types_1.SearchType.NONE;\n        this.simpleRefines = new Map();\n        this.complexRefines = new Map();\n        this.barQuery = factories_1.entryFactory.createBaseEntry();\n        this.refinesQuery = { keys: new Set(), vals: new Map(), simpleKeys: new Map() };\n    }\n    get query() {\n        return factories_1.entryFactory.createBaseEntry([\n            this.barQuery.raw,\n            ...Array.from(this.refinesQuery.keys.values()),\n            ...Array.from(this.refinesQuery.vals.keys()),\n            ...Array.from(this.refinesQuery.simpleKeys.keys())\n        ].join(\" \"));\n    }\n}\nexports.SearchModel = SearchModel;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst errors_1 = require(\"../errors\");\nconst factories_1 = require(\"../factories\");\nconst _1 = require(\".\");\nexports.journalController = {\n    addEntry: addEntry,\n    moveEntry: moveEntry,\n    buildTags: buildTags,\n    deleteEntry: deleteEntry,\n    loadEntries: loadEntries,\n};\nfunction unloadOtherJournals(keepJournal) {\n    __1.libraryModel.shelves.forEach(shelf => {\n        if (shelf === undefined)\n            return;\n        shelf.journals.forEach(journal => {\n            if (keepJournal.shelf.id !== journal.shelf.id || keepJournal.id !== journal.id) {\n                unloadEntries(journal);\n            }\n        });\n    });\n}\nfunction unloadEntries(journal) {\n    if (journal === undefined)\n        return;\n    journal.entries = [];\n    journal.loaded = false;\n}\nfunction loadEntries(journal) {\n    if (journal === undefined)\n        return;\n    unloadOtherJournals(journal);\n    _1.syncerController.getRows(journal.shelf.id, journal.id, journal.title)\n        .then(payload => {\n        payload.rows.forEach((content, idx) => addEntry(journal, idx, content, false));\n        journal.loaded = true;\n    })\n        .catch((error) => {\n        new errors_1.FriendlyError(error.error.message, error.friendlyMsg);\n    })\n        .finally(() => {\n        mithril_1.default.redraw();\n    });\n}\nfunction addEntry(journal, idx, content, sync) {\n    let entry = factories_1.entryFactory.createJournalEntry(journal.shelf, journal, content);\n    _1.entryController.save(entry, idx, content, sync);\n    journal.addEntry(idx, entry);\n    buildTags(journal);\n}\nfunction deleteEntry(journal, idx) {\n    journal.deleteEntry(idx);\n    buildTags(journal);\n}\nfunction moveEntry(journal, fromIdx, toIdx) {\n    if (fromIdx === toIdx)\n        return;\n    journal.moveEntry(fromIdx, toIdx);\n    buildTags(journal);\n}\nfunction buildTags(journal) {\n    let tags = new Map();\n    let entries = Array.from(journal.entries.values());\n    for (let { entry } of entries.reverse()) {\n        for (let [key, tag] of entry.tags) {\n            if (tags.has(key)) {\n                tags.get(key).frq += tag.frq;\n            }\n            else {\n                tags.set(key, factories_1.tagFactory.createTag(tag.raw, tag.flag, tag.key, tag.separator, tag.val));\n            }\n        }\n    }\n    journal.tags = tags;\n    _1.searchController.buildRefines(journal);\n}\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./shelfView\"));\n__export(require(\"./signinView\"));\n__export(require(\"./libraryView\"));\n__export(require(\"./journalView\"));\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst components_1 = require(\"../components\");\nfunction shelfView() {\n    function view() {\n        return mithril_1.default(\"#shelf\", [\n            mithril_1.default(components_1.googleComponent),\n            mithril_1.default(components_1.syncStateComponent),\n            mithril_1.default(components_1.breadcrumbComponent),\n            mithril_1.default(components_1.journalsComponent),\n        ]);\n    }\n    return {\n        view: view\n    };\n}\nexports.shelfView = shelfView;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst controllers_1 = require(\"../controllers\");\nfunction googleComponent() {\n    function view() {\n        return mithril_1.default(\"#googleApi\", [\n            preambleMessage(),\n            signInOutButton(),\n            mithril_1.default(\"script\", gapiScriptSettings()),\n        ]);\n    }\n    function gapiScriptSettings() {\n        return {\n            async: true,\n            defer: true,\n            src: __1.googleModel.src,\n            onload: () => {\n                if (!__1.googleModel.isSignedIn) {\n                    controllers_1.googleController.initGapi();\n                }\n            }\n        };\n    }\n    function signInOutButton() {\n        return (__1.googleModel.isSignedIn)\n            ? mithril_1.default(\"button\", { onclick: () => controllers_1.googleController.signOut(), class: \"authButton\" }, \"Sign Out\")\n            : mithril_1.default(\"button\", { onclick: () => controllers_1.googleController.signIn(), class: \"authButton\" }, \"Sign In\");\n    }\n    function preambleMessage() {\n        return (__1.googleModel.isSignedIn !== undefined && !__1.googleModel.isSignedIn)\n            ? mithril_1.default(\".preamble\", \"PREAMBLE MSG\")\n            : null;\n    }\n    return { view: view };\n}\nexports.googleComponent = googleComponent;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.textController = {\n    escape: escape,\n    clean: clean,\n};\nfunction escape(unsafe) {\n    return unsafe\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\");\n}\nfunction clean(content) {\n    return content.toLowerCase();\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst controllers_1 = require(\"../controllers\");\nconst models_1 = require(\"../models\");\nexports.tagFactory = {\n    createTag: createTag\n};\nfunction createTag(raw, flag, key, separator, val) {\n    separator = (separator !== undefined) ? separator : null;\n    val = (val !== undefined) ? val : null;\n    let clean = cleanTagString(raw);\n    let cleanKey = cleanTagString(key);\n    let cleanVal = (val !== null) ? cleanTagString(val) : null;\n    let renderedKey = \"<span onclick=\\\"tagOnClick(event, '\"\n        + flag\n        + cleanKey\n        + ((separator !== null) ? separator : \"\")\n        + \"')\\\" class=\\\"\"\n        + ((separator !== null) ? \"tagKey\" : (val === null) ? \"simpleTag\" : \"roundTagVal\")\n        + \"\\\">\"\n        + flag\n        + key\n        + \"</span>\";\n    let renderedVal = \"\";\n    if (separator !== undefined && separator !== null) {\n        renderedVal = \"<span onclick=\\\"tagOnClick(event, '\"\n            + flag\n            + cleanKey\n            + separator\n            + ((cleanVal !== null) ? cleanVal.replace(/'/, \"\\\\'\") : \"\")\n            + \"')\\\" class=\\\"tagVal\\\">\"\n            + separator\n            + ((val !== null) ? val : \"\")\n            + \"</span>\";\n    }\n    return new models_1.TagModel(raw, flag, key, separator, val, clean, cleanKey, cleanVal, renderedKey + renderedVal);\n}\nfunction cleanTagString(str) {\n    str = controllers_1.textController.escape(str);\n    str = (str.endsWith(\"'s\")) ? str.substring(0, str.length - 2) : str;\n    str = str.toLowerCase();\n    return str;\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst types_1 = require(\"../types\");\nclass UrlModel {\n    get hash() {\n        let url = new URL(window.location.href);\n        return url.hash;\n    }\n    set hash(hash_) {\n        window.location.hash = hash_;\n    }\n    get testMode() {\n        if (this.hash === \"#!demo\")\n            return types_1.TestMode.DEMO;\n        let test = mithril_1.default.route.param(\"test\");\n        return (test !== null && this.instanceOfTestMode(test)) ? test : types_1.TestMode.OFF;\n    }\n    instanceOfTestMode(str) {\n        return (Object.values(types_1.TestMode).includes(str));\n    }\n    get shelfId() {\n        let id = mithril_1.default.route.param(\"shelfId\");\n        return (id === \"\") ? undefined : id;\n    }\n    get journalId() {\n        let id = mithril_1.default.route.param(\"journalId\");\n        return (id === \"\") ? undefined : parseInt(id);\n    }\n}\nexports.UrlModel = UrlModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass TagModel {\n    constructor(raw, flag, key, separator, val, clean, cleanKey, cleanVal, rendered) {\n        this.raw = raw;\n        this.flag = flag;\n        this.key = key;\n        this.separator = separator;\n        this.val = val;\n        this.clean = clean;\n        this.cleanKey = cleanKey;\n        this.cleanVal = cleanVal;\n        this.rendered = rendered;\n        this.frq = 1;\n    }\n}\nexports.TagModel = TagModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass BaseEntryModel {\n    constructor() {\n        this.raw = \"\";\n        this.safe = \"\";\n        this.clean = \"\";\n        this.tokens = [];\n        this.rendered = \"\";\n        this.tags = new Map();\n        this.tagMatches = [];\n    }\n}\nexports.BaseEntryModel = BaseEntryModel;\nclass JournalEntryModel extends BaseEntryModel {\n    constructor(shelf, journal, entryId) {\n        super();\n        this.saved = \"\";\n        this.savedClean = \"\";\n        this.id = entryId;\n        this.shelf = shelf;\n        this.journal = journal;\n    }\n}\nexports.JournalEntryModel = JournalEntryModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass ShelfModel {\n    constructor(id, title, error) {\n        this.journals = new Map();\n        this.id = id;\n        this.error = error;\n        this.title = title;\n    }\n}\nexports.ShelfModel = ShelfModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst types_1 = require(\"../types\");\nclass SyncerModel {\n    constructor() {\n        this.requestsCounter = 0;\n        this.requests = new Map();\n        this.state = types_1.SyncerState.INITIALIZING;\n    }\n    pushSyncerTask(payload, worker) {\n        let id = `payload-${this.requestsCounter++}`;\n        return new Promise((resolve, reject) => {\n            this.requests.set(id, ({ payload, error }) => {\n                (error) ? reject(error) : resolve(payload);\n            });\n            worker.postMessage({ id, payload });\n        });\n    }\n}\nexports.SyncerModel = SyncerModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass GoogleModel {\n    constructor(isSignedIn) {\n        this.isSignedIn = isSignedIn;\n        this.src = \"https://apis.google.com/js/api.js\";\n        this.scope = [\n            \"https://www.googleapis.com/auth/spreadsheets\",\n        ].join(\" \");\n        this.clientId = \"893904323330-moo1k9s19qp40kr747pftdo29ejdef0o.apps.googleusercontent.com\";\n    }\n    get token() {\n        if (!this.user)\n            return;\n        let auth = this.user.getAuthResponse();\n        return auth.access_token;\n    }\n}\nexports.GoogleModel = GoogleModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass JournalModel {\n    constructor(shelf, journalId, journalTitle) {\n        this.entries = [];\n        this.shelf = shelf;\n        this.loaded = false;\n        this.id = journalId;\n        this.tags = new Map();\n        this.title = journalTitle;\n    }\n    addEntry(idx, entry) {\n        this.entries.splice(idx, 0, { id: entry.id, entry });\n    }\n    updateEntry(idx, entry) {\n        this.entries[idx].entry = entry;\n    }\n    deleteEntry(idx) {\n        this.entries.splice(idx, 1)[0];\n    }\n    moveEntry(fromIdx, toIdx) {\n        let entry = this.entries.splice(fromIdx, 1)[0];\n        this.entries.splice(toIdx, 0, entry);\n    }\n}\nexports.JournalModel = JournalModel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass LibraryModel {\n    constructor() {\n        this.shelves = new Map();\n        this.shelfIds.forEach(id => this.shelves.set(id, undefined));\n    }\n    set shelfIds(ids) {\n        localStorage.setItem(\"spreadsheetIds\", ids.join(\",\"));\n    }\n    get shelfIds() {\n        let ids = localStorage.getItem(\"spreadsheetIds\");\n        return (ids === null) ? [] : ids.split(\",\");\n    }\n}\nexports.LibraryModel = LibraryModel;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst errors_1 = require(\"../errors\");\nclass ServiceWorkerModel {\n    constructor() {\n        if (\"serviceWorker\" in navigator) {\n            window.addEventListener(\"load\", () => __awaiter(this, void 0, void 0, function* () {\n                yield navigator.serviceWorker.register(\"../serviceWorker.js\");\n            }));\n        }\n        else {\n            throw new errors_1.FriendlyError(\"serviceWorker not supported\", \"Your browser is not supported.\");\n        }\n    }\n}\nexports.ServiceWorkerModel = ServiceWorkerModel;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nclass FriendlyError extends Error {\n    constructor(errorMsg, friendlyMsg) {\n        super(errorMsg);\n        this.friendlyMsg = friendlyMsg;\n        console.warn(errorMsg);\n        mithril_1.default.redraw();\n    }\n}\nexports.FriendlyError = FriendlyError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst models_1 = require(\"../models\");\nexports.shelfFactory = {\n    createShelf: createShelf,\n};\nfunction createShelf(spreadsheetId, spreadsheet, error) {\n    if (spreadsheet !== undefined &&\n        spreadsheet.spreadsheetId !== undefined &&\n        spreadsheet.properties !== undefined &&\n        spreadsheet.properties.title !== undefined &&\n        spreadsheet.sheets !== undefined) {\n        let shelf = new models_1.ShelfModel(spreadsheet.spreadsheetId, spreadsheet.properties.title);\n        getJournals(shelf, spreadsheet.sheets).forEach(journal => shelf.journals.set(journal.id, journal));\n        return shelf;\n    }\n    return new models_1.ShelfModel(spreadsheetId, undefined, error);\n}\nfunction getJournals(shelf, sheets) {\n    let journals = [];\n    sheets.forEach(sheet => {\n        if (sheet.properties !== undefined &&\n            sheet.properties.title !== undefined &&\n            sheet.properties.sheetId !== undefined) {\n            let journal = new models_1.JournalModel(shelf, sheet.properties.sheetId, sheet.properties.title);\n            if (journal === undefined)\n                return;\n            journals.push(journal);\n        }\n    });\n    return journals;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst controllers_1 = require(\"../controllers\");\nconst models_1 = require(\"../models\");\nlet entryCounter = -1;\nexports.entryFactory = {\n    createBaseEntry: createBaseEntry,\n    createJournalEntry: createJournalEntry\n};\nfunction createBaseEntry(content) {\n    let entry = new models_1.BaseEntryModel();\n    controllers_1.entryController.update(entry, content || \"\");\n    return entry;\n}\nfunction createJournalEntry(shelf, journal, content) {\n    let entry = new models_1.JournalEntryModel(shelf, journal, entryCounter += 1);\n    controllers_1.entryController.update(entry, content);\n    return entry;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.caretController = {\n    getCaretPosition: getCaretPosition,\n    setCaretPosition: setCaretPosition,\n};\nfunction node_walk(node, func) {\n    var result = func(node);\n    for (node = node.firstChild; result !== false && node; node = node.nextSibling)\n        result = node_walk(node, func);\n    return;\n}\nfunction getCaretPosition(elem) {\n    var sel = window.getSelection();\n    var cum_length = [0, 0];\n    if (sel.anchorNode == elem) {\n        cum_length = [sel.anchorNode.innerText.length, sel.extentNode.innerText.length];\n    }\n    else {\n        var nodes_to_find = [sel.anchorNode, sel.extentNode];\n        if (!elem.contains(sel.anchorNode) || !elem.contains(sel.extentNode)) {\n            return undefined;\n        }\n        else {\n            var found = [0, 0];\n            var i;\n            node_walk(elem, function (node) {\n                for (i = 0; i < 2; i++) {\n                    if (node == nodes_to_find[i]) {\n                        found[i] = 1;\n                        if (found[i == 0 ? 1 : 0]) {\n                            return;\n                        }\n                    }\n                }\n                if (node.textContent && !node.firstChild) {\n                    for (i = 0; i < 2; i++) {\n                        if (!found[i]) {\n                            cum_length[i] += node.textContent.length;\n                        }\n                    }\n                }\n            });\n            cum_length[0] += sel.anchorOffset;\n            cum_length[1] += sel.extentOffset;\n        }\n    }\n    if (cum_length[0] <= cum_length[1]) {\n        return cum_length;\n    }\n    return [cum_length[1], cum_length[0]];\n}\nfunction setCaretPosition(el, pos) {\n    if (el !== null && pos !== null) {\n        for (var node of el.childNodes) {\n            if (node.nodeType == 3) {\n                if (node.length >= pos) {\n                    let range = document.createRange();\n                    let sel = window.getSelection();\n                    range.setStart(node, pos);\n                    range.collapse(true);\n                    sel.removeAllRanges();\n                    sel.addRange(range);\n                    return -1;\n                }\n                else {\n                    pos -= node.length;\n                }\n            }\n            else {\n                pos = setCaretPosition(node, pos);\n                if (pos == -1) {\n                    return -1;\n                }\n            }\n        }\n        return pos;\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst __1 = require(\"..\");\nconst types_1 = require(\"../types\");\nconst factories_1 = require(\"../factories\");\nconst entryController_1 = require(\"./entryController\");\nexports.searchController = {\n    reset: reset,\n    buildRefines: buildRefines,\n    filteredEntries: filteredEntries,\n    updateSearchbar: updateSearchbar,\n};\nfunction updateSearchbar(content) {\n    entryController_1.entryController.update(__1.searchModel.barQuery, content);\n}\nfunction reset() {\n    __1.searchModel.searchType = types_1.SearchType.NONE;\n    __1.searchModel.barQuery = factories_1.entryFactory.createBaseEntry();\n    __1.searchModel.refinesQuery = { keys: new Set(), vals: new Map(), simpleKeys: new Map() };\n}\nfunction buildRefines(journal) {\n    let simpleRefines = new Map();\n    let complexRefines = new Map();\n    for (let tag of journal.tags.values()) {\n        if (tag.val === null) {\n            let key = `${tag.flag}${tag.cleanKey}`;\n            if (!simpleRefines.has(key)) {\n                simpleRefines.set(key, tag);\n            }\n        }\n        else {\n            let key = `${tag.flag}${tag.cleanKey}${tag.separator}`;\n            if (!complexRefines.has(key)) {\n                complexRefines.set(key, []);\n            }\n            complexRefines.get(key).push(tag);\n        }\n    }\n    __1.searchModel.simpleRefines = new Map([...simpleRefines.entries()]);\n    __1.searchModel.complexRefines = new Map([...complexRefines.entries()].sort());\n    cleanRefines();\n}\nfunction cleanRefines() {\n    for (let [key,] of __1.searchModel.refinesQuery.simpleKeys) {\n        if (!__1.searchModel.simpleRefines.has(key)) {\n            __1.searchModel.refinesQuery.simpleKeys.delete(key);\n        }\n    }\n    for (let key of __1.searchModel.refinesQuery.keys) {\n        if (!__1.searchModel.complexRefines.has(key)) {\n            __1.searchModel.refinesQuery.keys.delete(key);\n        }\n    }\n    for (let [key,] of __1.searchModel.refinesQuery.vals) {\n        if (!Array.from(__1.searchModel.complexRefines.values()).some(tags => tags.some(tag => tag.clean === key))) {\n            __1.searchModel.refinesQuery.vals.delete(key);\n        }\n    }\n}\nfunction filteredEntries(entries) {\n    let filteredEntries = [];\n    if (__1.searchModel.query.tokens.length === 0) {\n        __1.searchModel.searchType = types_1.SearchType.NONE;\n        filteredEntries = entries.map(({ entry }, idx) => { return { idx, entry }; });\n    }\n    else {\n        __1.searchModel.searchType = types_1.SearchType.AND;\n        filteredEntries = search(entries);\n        if (filteredEntries.length === 0) {\n            __1.searchModel.searchType = types_1.SearchType.OR;\n            filteredEntries = search(entries);\n        }\n    }\n    return filteredEntries;\n}\nfunction search(entries) {\n    let query = __1.searchModel.query;\n    let sourceEntries = entries;\n    let filteredEntries = [];\n    for (let [idx, { entry }] of sourceEntries.entries()) {\n        switch (__1.searchModel.searchType) {\n            case types_1.SearchType.AND:\n                if (query.tokens.every(token => match(token, entry))) {\n                    filteredEntries.push({ idx, entry });\n                }\n                break;\n            case types_1.SearchType.OR:\n                if (query.tokens.some(token => match(token, entry))) {\n                    filteredEntries.push({ idx, entry });\n                }\n                break;\n        }\n    }\n    return filteredEntries;\n}\nfunction match(token, entry) {\n    if (token.startsWith(\"-@\") && !token.endsWith(\":\")) {\n        return entry.tags.get(token.substring(1)) === undefined;\n    }\n    else if (token.startsWith(\"-\")) {\n        return !entry.savedClean.includes(token.substring(1));\n    }\n    else if (token.startsWith(\"@\") && !token.endsWith(\":\")) {\n        return entry.tags.get(token) !== undefined;\n    }\n    else {\n        return entry.savedClean.includes(token);\n    }\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst mocks_1 = require(\"../mocks\");\nconst types_1 = require(\"../types\");\nconst __1 = require(\"..\");\nconst controllers_1 = require(\"../controllers\");\nexports.googleController = {\n    signIn: signIn,\n    signOut: signOut,\n    initGapi: initGapi,\n};\nfunction signOut() {\n    __1.googleModel.gapi_.auth2.getAuthInstance().signOut();\n}\nfunction signIn() {\n    __1.googleModel.gapi_.auth2.getAuthInstance().signIn();\n}\nfunction initGapi() {\n    let gapi_ = (__1.urlModel.testMode === types_1.TestMode.OFF) ? gapi : new mocks_1.MockGapi();\n    __1.googleModel.gapi_ = gapi_;\n    __1.googleModel.gapi_.load('auth2', () => {\n        __1.googleModel.gapi_.auth2.init({\n            scope: __1.googleModel.scope, client_id: __1.googleModel.clientId\n        }).then(() => {\n            __1.googleModel.gapi_.auth2.getAuthInstance().isSignedIn.listen(isSignedIn);\n            isSignedIn((__1.googleModel.gapi_.auth2.getAuthInstance().isSignedIn.get()));\n        });\n    });\n}\nfunction isSignedIn(signedIn) {\n    return __awaiter(this, void 0, void 0, function* () {\n        __1.googleModel.isSignedIn = signedIn;\n        if (__1.googleModel.isSignedIn) {\n            __1.googleModel.user = __1.googleModel.gapi_.auth2.getAuthInstance().currentUser.get();\n            controllers_1.syncerController.updateAuth(__1.googleModel.token);\n            controllers_1.libraryController.loadShelves();\n        }\n        else {\n            controllers_1.libraryController.removeShelves();\n        }\n        mithril_1.default.redraw();\n    });\n}\n","export * from \"./Gapi\"\n","export class MockGapi {\n    public auth2 = new MockAuth2()\n    public load(_api: string, _callback: () => void) {\n        _callback()\n    }\n}\n\nclass MockAuth2 {\n    public getAuthInstance() {\n        return new MockGoogleAuth()\n    }\n    public async init(_params: any) { }\n}\n\nclass MockCurrentUser {\n    public get() { return new MockGoogleUser() }\n}\n\nexport class MockGoogleUser {\n    public getAuthResponse() {\n        return {\n            expires_in: 9999,\n            access_token: \"faketoken\"\n        }\n    }\n    public async reloadAuthResponse() {\n        return {\n            expires_in: 9999,\n            access_token: \"faketoken\"\n        }\n    }\n}\n\nclass MockGoogleAuth {\n    public isSignedIn = new MockIsSignedIn()\n    public signOut() { }\n    public signIn() { }\n    public currentUser = new MockCurrentUser()\n}\n\nclass MockIsSignedIn {\n    public listen = (_callback: any) => { }\n    public get = () => { return true }\n}\n","import m from \"mithril\"\r\nimport { FriendlyError } from \"../errors\"\r\nimport { googleModel, syncerModel } from \"..\"\r\nimport { SyncerPayloadType, TestMode, SyncerPayload, ErrorPayload } from \"../types\"\r\n\r\nconst worker = new Worker(\"./js/syncWebWorker.js\")\r\nworker.onmessage = (msg: MessageEvent) => onMessage(msg)\r\n\r\nexport const syncerController = {\r\n    unpause: unpause,\r\n    getRows: getRows,\r\n    deleteRow: deleteRow,\r\n    updateRow: updateRow,\r\n    getSheets: getSheets,\r\n    updateAuth: updateAuth,\r\n    updateTestMode: updateTestMode,\r\n    getSpreadsheet: getSpreadsheet,\r\n}\r\n\r\nasync function updateTestMode(testMode: TestMode) {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.TEST_MODE_UPDATE,\r\n        testMode: testMode,\r\n    }, worker)\r\n}\r\n\r\nfunction updateAuth(token: string | undefined) {\r\n    if (token === undefined) return\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.AUTH_UPDATE,\r\n        token: token,\r\n    }, worker)\r\n}\r\n\r\nfunction getSpreadsheet(spreadsheetId: string) {\r\n    let spreadsheet: gapi.client.sheets.Spreadsheet | undefined = undefined\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.GET_SPREADSHEET,\r\n        spreadsheetId: spreadsheetId,\r\n        spreadsheet: spreadsheet\r\n    }, worker)\r\n}\r\n\r\nfunction getSheets(spreadsheetId: string) {\r\n    let sheets: gapi.client.sheets.Sheet[] = []\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.GET_SHEETS,\r\n        spreadsheetId: spreadsheetId,\r\n        sheets: sheets\r\n    }, worker)\r\n}\r\n\r\nfunction getRows(shelfId: string, journalId: number, journalTitle: string) {\r\n    let rows: string[] = []\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.GET_ROWS,\r\n        spreadsheetId: shelfId,\r\n        sheetTitle: journalTitle,\r\n        sheetId: journalId,\r\n        rows: rows\r\n    }, worker)\r\n}\r\n\r\nasync function deleteRow(idx: number, spreadsheetId: string, sheetId: number) {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.DELETE_ROW,\r\n        spreadsheetId: spreadsheetId,\r\n        sheetId: sheetId,\r\n        idx: idx,\r\n    }, worker)\r\n}\r\n\r\nasync function updateRow(shelfId: string, journalId: number, journalTitle: string, idx: number, content: string) {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.UPDATE_ROW,\r\n        spreadsheetId: shelfId,\r\n        sheetTitle: journalTitle,\r\n        sheetId: journalId,\r\n        content: content,\r\n        idx: idx,\r\n    }, worker)\r\n}\r\n\r\n// TODO: updateRow\r\n\r\nasync function unpause() {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.UNPAUSE\r\n    }, worker)\r\n}\r\n\r\nfunction onMessage(msg: MessageEvent) {\r\n    let { id, payload, error }: { id: string | null, payload: SyncerPayload, error: ErrorPayload } = msg.data\r\n    if (id !== null && syncerModel.requests.has(id)) {\r\n        syncerModel.requests.get(id)!({ payload, error })\r\n        syncerModel.requests.delete(id)\r\n    } else {\r\n        switch (payload.type) {\r\n            case SyncerPayloadType.SYNC_STATE:\r\n                syncerModel.state = payload.state\r\n                m.redraw()\r\n                break\r\n            case SyncerPayloadType.ERROR:\r\n                new FriendlyError(payload.error.message, payload.friendlyMsg)\r\n                break\r\n            case SyncerPayloadType.TOKEN_REQUEST:\r\n                updateAuth(googleModel.token)\r\n                break\r\n        }\r\n    }\r\n}\r\n\r\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst errors_1 = require(\"../errors\");\nconst factories_1 = require(\"../factories\");\nconst controllers_1 = require(\"../controllers\");\nconst urlController_1 = require(\"./urlController\");\nconst journalController_1 = require(\"./journalController\");\nconst spreadsheetIdPattern = /\\/spreadsheets\\/d\\/([a-zA-Z0-9-_]+)/g;\nexports.libraryController = {\n    addShelves: addShelves,\n    loadShelves: loadShelves,\n    removeShelves: removeShelves,\n    getSpreadsheetIdsFromUrls: getSpreadsheetIdsFromUrls,\n};\nfunction addShelves(urls) {\n    let ids = getSpreadsheetIdsFromUrls(urls);\n    ids = ids.filter(id => !__1.libraryModel.shelves.has(id));\n    ids.forEach(id => __1.libraryModel.shelves.set(id, undefined));\n    __1.libraryModel.shelfIds = Array.from(__1.libraryModel.shelves.keys());\n    loadShelves(false, ids);\n}\nfunction removeShelves(ids) {\n    if (ids === undefined)\n        ids = Array.from(__1.libraryModel.shelves.keys());\n    ids = ids.filter(id => __1.libraryModel.shelves.has(id));\n    ids.forEach(id => __1.libraryModel.shelves.delete(id));\n    __1.libraryModel.shelfIds = Array.from(__1.libraryModel.shelves.keys());\n}\nfunction loadShelves(reloadLoaded, ids) {\n    if (ids === undefined)\n        ids = Array.from(__1.libraryModel.shelves.keys());\n    if (reloadLoaded) {\n        ids.forEach(id => __1.libraryModel.shelves.set(id, undefined));\n        mithril_1.default.redraw();\n    }\n    ids.filter(id => !__1.libraryModel.shelves.get(id))\n        .forEach(id => controllers_1.syncerController.getSpreadsheet(id)\n        .then(payload => {\n        let shelf = factories_1.shelfFactory.createShelf(id, payload.spreadsheet);\n        __1.libraryModel.shelves.set(shelf.id, shelf);\n        let journal = urlController_1.urlController.getActiveJournal();\n        if (journal && journal.shelf === shelf) {\n            journalController_1.journalController.loadEntries(journal);\n        }\n    })\n        .catch((error) => {\n        new errors_1.FriendlyError(error.error.message, error.friendlyMsg);\n        let shelf = factories_1.shelfFactory.createShelf(id, undefined, error.friendlyMsg);\n        __1.libraryModel.shelves.set(id, shelf);\n    })\n        .finally(() => {\n        mithril_1.default.redraw();\n    }));\n}\nfunction getSpreadsheetIdsFromUrls(urls) {\n    let ids = [];\n    if (urls) {\n        Array.from(urls.matchAll(spreadsheetIdPattern)).forEach(m => ids.push(m[1]));\n    }\n    return ids;\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst factories_1 = require(\"../factories\");\nconst controllers_1 = require(\"../controllers\");\nfunction composeComponent() {\n    var caret = { el: null, pos: null };\n    const composePrefixEntry = factories_1.entryFactory.createBaseEntry();\n    const composeContentEntry = factories_1.entryFactory.createBaseEntry();\n    const composeSuffixEntry = factories_1.entryFactory.createBaseEntry();\n    const prefixSettings = { \"placeholder\": \"Static Entry Prefix\" };\n    const entrySettings = { \"placeholder\": \"Entry Content\" };\n    const suffixSettings = { \"placeholder\": \"Static Entry Suffix\" };\n    function view() {\n        const journal = controllers_1.urlController.getActiveJournal();\n        if (journal === undefined || journal.loaded === false)\n            return;\n        return mithril_1.default(\"#compose\", [\n            mithril_1.default(\"#prefix\", composeNodeSettings(composePrefixEntry, journal, prefixSettings), mithril_1.default.trust(composePrefixEntry.rendered)),\n            mithril_1.default(\"#content\", composeNodeSettings(composeContentEntry, journal, entrySettings), mithril_1.default.trust(composeContentEntry.rendered)),\n            mithril_1.default(\"#suffix\", composeNodeSettings(composeSuffixEntry, journal, suffixSettings), mithril_1.default.trust(composeSuffixEntry.rendered)),\n        ]);\n    }\n    function getComposedContent() {\n        let els = [\n            document.getElementById(\"prefix\"),\n            document.getElementById(\"content\"),\n            document.getElementById(\"suffix\"),\n        ];\n        return els.map(el => el.innerText).join(\"\");\n    }\n    function composeNodeSettings(entry, journal, extraSettings) {\n        let baseSettings = {\n            contenteditable: \"true\",\n            class: \"entry breakwrap column\",\n            onkeydown: (event) => __awaiter(this, void 0, void 0, function* () { return yield composeKeydown(event, journal); }),\n            oninput: (event) => composeInput(event, entry),\n            onupdate: () => composeUpdate(),\n        };\n        return Object.assign(baseSettings, extraSettings);\n    }\n    function composeKeydown(event, journal) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (event.keyCode == 13 && !event.shiftKey) {\n                event.preventDefault();\n                let content = getComposedContent();\n                controllers_1.entryController.update(composeContentEntry, \"\");\n                let idx = journal.entries.length;\n                controllers_1.journalController.addEntry(journal, idx, content, true);\n            }\n        });\n    }\n    function composeInput(event, entry) {\n        let pos = controllers_1.caretController.getCaretPosition(event.target);\n        caret.pos = (pos) ? pos[1] : null;\n        caret.el = event.target;\n        controllers_1.entryController.update(entry, event.target.innerText);\n    }\n    function composeUpdate() {\n        controllers_1.caretController.setCaretPosition(caret.el, caret.pos);\n        caret.pos = null;\n        caret.el = null;\n    }\n    return { view: view };\n}\nexports.composeComponent = composeComponent;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst controllers_1 = require(\"../controllers\");\nfunction entriesComponent() {\n    const caret = { pos: null, el: null };\n    function view() {\n        let shelf = controllers_1.urlController.getActiveShelf();\n        const journal = controllers_1.urlController.getActiveJournal();\n        if (!shelf || !journal)\n            return null;\n        return mithril_1.default(\"#entries\", [\n            mithril_1.default(\".tempguidancePre\", \"Entries\"),\n            entriesList(journal),\n        ]);\n    }\n    function entriesList(journal) {\n        return controllers_1.searchController.filteredEntries(journal.entries)\n            .map(({ idx, entry }) => entryVnode(entry, idx));\n    }\n    function entryVnode(entry, entryIdx) {\n        return mithril_1.default(\".entryWrap\", { id: `entry-${entry.id}` }, [\n            entryContent(entry, entryIdx),\n            deleteEntryButton(entry, entryIdx),\n        ]);\n    }\n    function deleteEntryButton(entry, entryIdx) {\n        return mithril_1.default(\"button\", {\n            class: \"del\",\n            onclick: () => __awaiter(this, void 0, void 0, function* () { return controllers_1.journalController.deleteEntry(entry.journal, entryIdx); })\n        }, \"del\");\n    }\n    function entryContent(entry, entryIdx) {\n        return mithril_1.default(\"div\", entryContentSettings(entry, entryIdx), mithril_1.default.trust(entry.rendered));\n    }\n    function onEntryKeydown(event) {\n        event.redraw = false;\n        if (event.keyCode == 13 && !event.shiftKey) {\n            event.preventDefault();\n            event.target.blur();\n        }\n    }\n    function onEntryInput(event, entry) {\n        let pos = controllers_1.caretController.getCaretPosition(event.target);\n        caret.pos = (pos) ? pos[1] : null;\n        caret.el = event.target;\n        controllers_1.entryController.update(entry, event.target.innerText);\n    }\n    function onEntryUpdate(event) {\n        event.redraw = false;\n        controllers_1.caretController.setCaretPosition(caret.el, caret.pos);\n        caret.pos = null;\n        caret.el = null;\n    }\n    function onEntryBlur(event, entry, entryIdx) {\n        return __awaiter(this, void 0, void 0, function* () {\n            event.redraw = false;\n            controllers_1.entryController.save(entry, entryIdx, event.target.innerText, true);\n            controllers_1.journalController.buildTags(entry.journal);\n        });\n    }\n    function entryContentSettings(entry, entryIdx) {\n        return {\n            id: `entry-${entry.id}-content`,\n            contenteditable: \"true\",\n            class: \"entry breakwrap column\",\n            onkeydown: (event) => onEntryKeydown(event),\n            oninput: (event) => onEntryInput(event, entry),\n            onupdate: (event) => onEntryUpdate(event),\n            onblur: (event) => onEntryBlur(event, entry, entryIdx),\n        };\n    }\n    return { view: view };\n}\nexports.entriesComponent = entriesComponent;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst controllers_1 = require(\"../controllers\");\nfunction shelvesComponent() {\n    function view() {\n        let shelves = Array.from(__1.libraryModel.shelves.entries());\n        return mithril_1.default(\"#shelvesList\", shelves.map(([id, shelf]) => shelfNode(id, shelf)));\n    }\n    function delShelfButton(id) {\n        return mithril_1.default(\"button\", {\n            class: \"del\",\n            onclick: () => controllers_1.libraryController.removeShelves([id])\n        }, \"del\");\n    }\n    function retryShelfLoadButton(id) {\n        return mithril_1.default(\"button\", {\n            onclick: () => controllers_1.libraryController.loadShelves(true, [id])\n        }, \"retry\");\n    }\n    function shelfNode(id, shelf) {\n        if (shelf === undefined) {\n            return mithril_1.default(\"li\", [\n                delShelfButton(id),\n                mithril_1.default(\"span\", id)\n            ]);\n        }\n        else if (shelf.error !== undefined) {\n            return mithril_1.default(\"li\", [\n                delShelfButton(id),\n                mithril_1.default(\"span\", `${id} ${shelf.error}`),\n                retryShelfLoadButton(id)\n            ]);\n        }\n        else {\n            return mithril_1.default(\"li\", [\n                delShelfButton(id),\n                mithril_1.default(\"a\", { href: `#/library/${id}` }, shelf.title)\n            ]);\n        }\n    }\n    return {\n        view: view,\n    };\n}\nexports.shelvesComponent = shelvesComponent;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst controllers_1 = require(\"../controllers\");\nfunction refinesComponent() {\n    const simpleTagsHeader = \"Simple Tags\";\n    const expanded = new Set();\n    function view() {\n        const journal = controllers_1.urlController.getActiveJournal();\n        if (journal === undefined || journal.loaded === false)\n            return;\n        return mithril_1.default(\"#tagsWrap\", mithril_1.default(\"#tags\", [\n            mithril_1.default(\".tempguidancePre\", \"Tags\"),\n            simpleRefinesVnodes(),\n            complexRefinesVnodes(),\n        ]));\n    }\n    function simpleRefinesVnodes() {\n        if (__1.searchModel.simpleRefines.size === 0)\n            return;\n        return mithril_1.default(\".tagRefineWrap\", [\n            refineKeyVnode(simpleTagsHeader, __1.searchModel.simpleRefines.size),\n            Array.from(__1.searchModel.simpleRefines, ([key, tag]) => [\n                refineValVnode(key, tag)\n            ])\n        ]);\n    }\n    function complexRefinesVnodes() {\n        return Array.from(__1.searchModel.complexRefines, ([key, tags]) => mithril_1.default(\".tagRefineWrap\", [\n            refineKeyVnode(key, tags.length),\n            tags.map(tag => [refineValVnode(key, tag)])\n        ]));\n    }\n    function refineKeyVnode(key, count) {\n        return mithril_1.default(\"span\", tagRefineKeySettings(key), [\n            (key === simpleTagsHeader)\n                ? []\n                : mithril_1.default(\"input\", { type: \"checkbox\", checked: __1.searchModel.refinesQuery.keys.has(key) }),\n            (expanded.has(key)) ? mithril_1.default(\"span\", \"▾ \") : mithril_1.default(\"span\", \"▿ \"),\n            mithril_1.default(\"span\", key),\n            mithril_1.default(\"span\", ` (${count})`),\n        ]);\n    }\n    function refineValVnode(key, tag) {\n        return mithril_1.default(\"div\", { class: `tagRefineValWrap` }, [\n            mithril_1.default(\"span\", tagRefineValSettings(key, tag), [\n                mithril_1.default(\"input\", {\n                    type: \"checkbox\", checked: (tag.val === null)\n                        ? __1.searchModel.refinesQuery.simpleKeys.has(tag.clean)\n                        : __1.searchModel.refinesQuery.vals.has(tag.clean)\n                }),\n                (tag.val !== null)\n                    ? mithril_1.default(\"span\", `${tag.cleanVal}`)\n                    : mithril_1.default(\"span\", `${tag.flag}${tag.cleanKey}`),\n                mithril_1.default(\"span\", ` (${tag.frq})`),\n            ]),\n        ]);\n    }\n    function tagRefineKeySettings(key) {\n        return {\n            class: \"roundTagKey\",\n            onclick: (event) => refineTagKeyOnClick(event, key),\n        };\n    }\n    function tagRefineValSettings(key, tag) {\n        let tagClass = (tag.val === null) ? \"simpleTag\" : \"roundTagVal\";\n        let hideClass = \"hide\";\n        if ((tag.val === null && expanded.has(simpleTagsHeader)) ||\n            expanded.has(key) ||\n            __1.searchModel.refinesQuery.vals.has(tag.clean)) {\n            hideClass = \"\";\n        }\n        return {\n            class: `${tagClass} ${hideClass}`,\n            onclick: () => refineTagValOnClick(tag),\n        };\n    }\n    function refineTagKeyOnClick(event, key) {\n        if (!event.metaKey && !event.ctrlKey) {\n            expanded.has(key) ? expanded.delete(key) : expanded.add(key);\n        }\n        else {\n            if (key === simpleTagsHeader) {\n                return;\n            }\n            __1.searchModel.refinesQuery.keys.has(key)\n                ? __1.searchModel.refinesQuery.keys.delete(key)\n                : __1.searchModel.refinesQuery.keys.add(key);\n        }\n    }\n    function refineTagValOnClick(tag) {\n        if (tag.val === null) {\n            __1.searchModel.refinesQuery.simpleKeys.has(tag.clean)\n                ? __1.searchModel.refinesQuery.simpleKeys.delete(tag.clean)\n                : __1.searchModel.refinesQuery.simpleKeys.set(tag.clean, tag);\n        }\n        else {\n            __1.searchModel.refinesQuery.vals.has(tag.clean)\n                ? __1.searchModel.refinesQuery.vals.delete(tag.clean)\n                : __1.searchModel.refinesQuery.vals.set(tag.clean, tag);\n        }\n    }\n    return { view: view };\n}\nexports.refinesComponent = refinesComponent;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst controllers_1 = require(\"../controllers\");\nfunction journalsComponent() {\n    function view() {\n        return mithril_1.default(\"#journals\", journalList());\n    }\n    function journalList() {\n        let shelf = controllers_1.urlController.getActiveShelf();\n        if (shelf === undefined) {\n            controllers_1.urlController.redirect(\"/library\");\n            return;\n        }\n        return Array.from(shelf.journals.values()).map(journal => {\n            let link = `#/library/${journal.shelf.id}/${journal.id}`;\n            return mithril_1.default(\"li\", mithril_1.default(\"a\", { href: link }, journal.title + \" \" + journal.loaded));\n        });\n    }\n    return {\n        view: view,\n    };\n}\nexports.journalsComponent = journalsComponent;\n","import m from \"mithril\"\nimport { syncerModel } from \"..\"\nimport { SyncerState } from \"../types\"\nimport { syncerController } from \"../controllers\"\n\nexport function syncStateComponent() {\n\n    function view() {\n        return m(\"#status\", m(\"span\", syncState()))\n    }\n\n    function syncState() {\n        return m(\"span\", [\n            syncStateIcon(),\n            syncStateText(),\n            unpauseSync()\n        ])\n    }\n\n    function syncStateText() {\n        let txt = \"\"\n        let class_ = `syncState ${stateColorClass()}`\n\n        switch (syncerModel.state) {\n            case SyncerState.DOWNLOADING:\n                txt = \"Downloading journal data from drive...\"\n                break\n            case SyncerState.PAUSED:\n                txt = \"Warning! - Syncing is paused.\"\n                break\n            case SyncerState.SYNCED:\n                txt = \"Cloud synced.\"\n                break\n            case SyncerState.UPLOADING:\n                txt = \"Uploading changes to drive...\"\n                break\n            case SyncerState.INITIALIZING:\n                txt = \"Initializing...\"\n        }\n        return m(\"span\", { id: \"syncStateText\", class: class_ }, txt)\n    }\n\n    function syncStateIcon() {\n        let class_ = `material-icons material-icons-outlined syncState ${stateColorClass()}`\n        return m(\"i\", { id: \"syncStateIcon\", class: class_ }, syncerModel.state)\n    }\n\n    function unpauseSync() {\n        if (syncerModel.state === SyncerState.PAUSED) {\n            return m(\"button\", {\n                id: \"unpauseSync\",\n                class: \"syncState\",\n                onclick: () => syncerController.unpause()\n            }, \"Unpause Syncing\")\n        }\n        return\n    }\n\n    function stateColorClass() {\n        switch (syncerModel.state) {\n            case SyncerState.PAUSED:\n                return \"error\"\n            case SyncerState.SYNCED:\n                return \"okay\"\n            default:\n                return \"warn\"\n        }\n    }\n\n    return { view: view }\n}\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst controllers_1 = require(\"../controllers\");\nfunction searchbarComponent() {\n    const caret = { pos: null, el: null };\n    function view() {\n        const journal = controllers_1.urlController.getActiveJournal();\n        if (journal === undefined || journal.loaded === false)\n            return;\n        return mithril_1.default(\"#search\", [\n            mithril_1.default(\"#searchQuery\", searchNodeSettings(), mithril_1.default.trust(__1.searchModel.barQuery.rendered)),\n            mithril_1.default(\"button\", clearSearchNodeSettings(), \"x\")\n        ]);\n    }\n    function searchNodeSettings() {\n        return {\n            placeholder: \"Search for text or tags\",\n            contenteditable: \"true\",\n            class: `entry breakwrap`,\n            oninput: (event) => onSearchInput(event),\n            onupdate: () => onSearchUpdate(),\n            onkeydown: (event) => onSearchKeydown(event)\n        };\n    }\n    function onSearchInput(event) {\n        let pos = controllers_1.caretController.getCaretPosition(event.target);\n        caret.pos = (pos) ? pos[1] : null;\n        caret.el = event.target;\n        controllers_1.searchController.updateSearchbar(controllers_1.textController.escape(event.target.innerText));\n    }\n    function onSearchUpdate() {\n        controllers_1.caretController.setCaretPosition(caret.el, caret.pos);\n        caret.pos = null;\n        caret.el = null;\n    }\n    function onSearchKeydown(event) {\n        if (event.keyCode == 13 && !event.shiftKey) {\n            event.preventDefault();\n            event.target.blur();\n        }\n    }\n    function clearSearchNodeSettings() {\n        return {\n            id: \"clearSearch\",\n            class: \"del\",\n            onclick: () => controllers_1.searchController.updateSearchbar(\"\")\n        };\n    }\n    return { view: view };\n}\nexports.searchbarComponent = searchbarComponent;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst controllers_1 = require(\"../controllers\");\nfunction addShelvesComponent() {\n    let newShelfUrls = \"\";\n    let addingShelves = false;\n    function view() {\n        return mithril_1.default(\"#addShelves\", [\n            addShelvesButton(),\n            addShelvesTextbox(),\n        ]);\n    }\n    function addShelvesButton() {\n        return mithril_1.default(\"button\", {\n            id: \"addShelvesButton\",\n            onclick: () => __awaiter(this, void 0, void 0, function* () {\n                if (addingShelves)\n                    controllers_1.libraryController.addShelves(newShelfUrls);\n                newShelfUrls = \"\";\n                addingShelves = !addingShelves;\n            })\n        }, (addingShelves) ? \" ✓ \" : \"+/-\");\n    }\n    function addShelvesTextbox() {\n        if (!addingShelves)\n            return null;\n        return mithril_1.default(\"textarea\", {\n            id: \"addShelvesText\",\n            placeholder: \"Enter list of Google Sheets Spreadsheet URLs here\",\n            oninput: (event) => newShelfUrls = event.target.value\n        });\n    }\n    return {\n        view: view,\n    };\n}\nexports.addShelvesComponent = addShelvesComponent;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst controllers_1 = require(\"../controllers\");\nfunction breadcrumbComponent() {\n    function view() {\n        return mithril_1.default(\"#breadcrumb\", controllers_1.urlController.getBreadcrumbTrail());\n    }\n    return {\n        view: view,\n    };\n}\nexports.breadcrumbComponent = breadcrumbComponent;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst __1 = require(\"..\");\nconst components_1 = require(\"../components\");\nfunction signinView() {\n    function view() {\n        return mithril_1.default(\"#auth\", [\n            mithril_1.default(components_1.googleComponent),\n        ]);\n    }\n    function onupdate() {\n        if (__1.googleModel.isSignedIn) {\n            window.location.hash = \"/library\";\n        }\n    }\n    return {\n        view: view,\n        onupdate: onupdate,\n    };\n}\nexports.signinView = signinView;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst components_1 = require(\"../components\");\nfunction libraryView() {\n    function view() {\n        return mithril_1.default(\"#library\", [\n            mithril_1.default(components_1.googleComponent),\n            mithril_1.default(components_1.syncStateComponent),\n            mithril_1.default(components_1.addShelvesComponent),\n            mithril_1.default(components_1.shelvesComponent),\n        ]);\n    }\n    return {\n        view: view\n    };\n}\nexports.libraryView = libraryView;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst mithril_1 = __importDefault(require(\"mithril\"));\nconst controllers_1 = require(\"../controllers\");\nconst components_1 = require(\"../components\");\nfunction journalView() {\n    function oninit() {\n        const journal = controllers_1.urlController.getActiveJournal();\n        if (journal === undefined || journal.loaded)\n            return;\n        controllers_1.journalController.loadEntries(journal);\n    }\n    function view() {\n        return mithril_1.default(\"#shelf\", [\n            mithril_1.default(components_1.googleComponent),\n            mithril_1.default(components_1.syncStateComponent),\n            mithril_1.default(components_1.breadcrumbComponent),\n            mithril_1.default(components_1.searchbarComponent),\n            mithril_1.default(components_1.refinesComponent),\n            mithril_1.default(\"#entriesWrap\", [\n                mithril_1.default(components_1.entriesComponent),\n                mithril_1.default(components_1.composeComponent),\n            ])\n        ]);\n    }\n    return {\n        view: view,\n        oninit: oninit,\n    };\n}\nexports.journalView = journalView;\n"],"sourceRoot":""}