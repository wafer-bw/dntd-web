{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/types/index.ts","webpack:///external \"m\"","webpack:///./src/index.ts","webpack:///./src/helpers/index.ts","webpack:///./src/controllers/index.ts","webpack:///./src/models/index.ts","webpack:///./src/views/components/index.ts","webpack:///./src/types/errors.ts","webpack:///./src/types/search.ts","webpack:///./src/types/testing.ts","webpack:///./src/types/syncer.ts","webpack:///./src/views/index.ts","webpack:///./src/views/shelfView.ts","webpack:///./src/views/components/googleComponent.ts","webpack:///./src/controllers/googleController.ts","webpack:///./src/mocks/index.ts","webpack:///./src/mocks/Gapi.ts","webpack:///./src/helpers/misc.ts","webpack:///./src/helpers/errors.ts","webpack:///./src/helpers/textOps.ts","webpack:///./src/helpers/caretOps.ts","webpack:///./src/helpers/patterns.ts","webpack:///./src/controllers/SyncerController.ts","webpack:///./src/controllers/libraryController.ts","webpack:///./src/models/TagModel.ts","webpack:///./src/models/EntryModel.ts","webpack:///./src/models/ShelfModel.ts","webpack:///./src/models/SyncerModel.ts","webpack:///./src/models/GoogleModel.ts","webpack:///./src/models/JournalModel.ts","webpack:///./src/models/LibraryModel.ts","webpack:///./src/models/ServiceWorkerModel.ts","webpack:///./src/controllers/storageController.ts","webpack:///./src/views/components/shelvesComponent.ts","webpack:///./src/views/components/journalsComponent.ts","webpack:///./src/views/components/syncStateComponent.ts","webpack:///./src/views/components/addShelvesComponent.ts","webpack:///./src/views/components/breadcrumbComponent.ts","webpack:///./src/views/signinView.ts","webpack:///./src/views/libraryView.ts","webpack:///./src/views/journalView.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","serviceWorkerModel","ServiceWorkerModel","googleModel","GoogleModel","syncerModel","SyncerModel","libraryModel","LibraryModel","root","document","getElementById","route","signinView","libraryView","shelfView","journalView","SyncerError","Error","errorMsg","friendlyMsg","needsReAuth","pause","super","this","payload","undefined","error","type","SyncerPayloadType","ERROR","SearchType","TestMode","SyncerResponseType","SyncerState","view","breadcrumbComponent","googleComponent","syncStateComponent","journalsComponent","isSignedIn","onclick","googleController","signOut","class","signIn","async","defer","src","onload","initGapi","signedIn","user","gapi_","auth2","getAuthInstance","currentUser","syncerController","updateAuth","token","libraryController","loadShelves","removeShelves","redraw","getTestMode","OFF","gapi","MockGapi","load","init","scope","client_id","clientId","then","listen","MockAuth2","_api","_callback","MockGoogleAuth","_params","MockCurrentUser","MockGoogleUser","expires_in","access_token","MockIsSignedIn","URL","window","location","href","hash","url","DEMO","test","searchParams","str","values","includes","FriendlyError","console","warn","unsafe","replace","elem","sel","getSelection","cum_length","anchorNode","innerText","length","extentNode","nodes_to_find","contains","found","node_walk","node","func","result","firstChild","nextSibling","textContent","anchorOffset","extentOffset","setCaretPosition","el","pos","childNodes","nodeType","range","createRange","setStart","collapse","removeAllRanges","addRange","tagPattern","worker","Worker","pushSyncerTask","AUTH_UPDATE","onmessage","msg","id","data","requests","has","delete","SYNC_STATE","state","message","TOKEN_REQUEST","onMessage","unpause","UNPAUSE","getRows","spreadsheetId","sheetId","sheetTitle","GET_ROWS","rows","deleteRow","idx","DELETE_ROW","updateRow","content","UPDATE_ROW","getSheets","GET_SHEETS","sheets","updateTestMode","testMode","TEST_MODE_UPDATE","getSpreadsheet","GET_SPREADSHEET","spreadsheet","shelfFactory","ShelfFactory","spreadsheetIdPattern","reloadLoaded","ids","Array","from","shelves","keys","forEach","set","filter","shelf","createShelf","catch","finally","getSpreadsheetIdsFromUrls","urls","matchAll","push","addShelves","shelfIds","raw","flag","separator","val","frq","clean","cleanTagString","cleanKey","cleanVal","hideKeys","renderVal","renderKey","escapeHtml","endsWith","substring","toLowerCase","saved","tags","Map","hovered","focused","tokens","rendered","savedClean","tagMatches","readableRendered","rawText","savedText","getTags","safe","getTokens","getTagMatches","render","text","tag","match","chars","split","splice","index","join","matchesIter","TagModel","sort","a","b","trim","journalFactory","JournalFactory","properties","title","journals","getJournals","ShelfModel","sheet","journal","createJournal","addJournals","requestsCounter","SYNCED","Promise","resolve","reject","postMessage","getAuthResponse","shelfId","JournalModel","entries","entry","reverse","EntryModel","buildTags","fromIdx","toIdx","x","localStorage","setItem","getItem","navigator","addEventListener","serviceWorker","register","storageController","setSpreadsheetId","getSpreadsheetId","getSpreadsheetSheetId","parseInt","setSpreadsheetSheetId","toString","delSpreadsheetSheetId","removeItem","delShelfButton","retryShelfLoadButton","map","shelfNode","param","link","journalList","syncStateText","txt","class_","stateColorClass","DOWNLOADING","PAUSED","UPLOADING","syncStateIcon","unpauseSync","newShelfUrls","addingShelves","addShelvesButton","addShelvesTextbox","placeholder","oninput","event","target","breadcrumb","getHash","crumb","trail","slice","breadcrumbs","onupdate","addShelvesComponent","shelvesComponent"],"mappings":"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","file":"dntd.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","export * from \"./caret\"\nexport * from \"./errors\"\nexport * from \"./search\"\nexport * from \"./testing\"\nexport * from \"./syncer\"\n","module.exports = m;","import m from \"mithril\"\nimport { signinView, libraryView, shelfView, journalView } from \"./views\"\nimport { ServiceWorkerModel, SyncerModel, LibraryModel, GoogleModel } from \"./models\"\n\nexport const serviceWorkerModel = new ServiceWorkerModel()\nexport const googleModel = new GoogleModel()\nexport const syncerModel = new SyncerModel()\nexport const libraryModel = new LibraryModel()\n\nconst root = document.getElementById(\"root\")\n\nif (root !== null) {\n    m.route(root, \"/\", {\n        \"/\": signinView,                                   // TODO decide what this should be\n        \"/signin\": signinView,\n        \"/library\": libraryView,\n        \"/library/:shelfId\": shelfView,\n        \"/library/:shelfId/:journalId\": journalView,\n        // \"/demo\" : app,                                   // TODO\n        // \"/about\": about,                                 // TODO\n    })\n}\n","export * from \"./misc\"\nexport * from \"./errors\"\nexport * from \"./textOps\"\nexport * from \"./caretOps\"\nexport * from \"./patterns\"\n","export * from \"./googleController\"\r\nexport * from \"./SyncerController\"\r\nexport * from \"./libraryController\"\r\nexport * from \"./storageController\"\r\n","export * from \"./TagModel\"\r\nexport * from \"./EntryModel\"\r\nexport * from \"./ShelfModel\"\r\nexport * from \"./SyncerModel\"\r\nexport * from \"./GoogleModel\"\r\nexport * from \"./JournalModel\"\r\nexport * from \"./LibraryModel\"\r\nexport * from \"./ServiceWorkerModel\"\r\n","// TODO: remove old components directory at src/components and replace with this directory\nexport * from \"./googleComponent\"\nexport * from \"./shelvesComponent\"\nexport * from \"./journalsComponent\"\nexport * from \"./syncStateComponent\"\nexport * from \"./addShelvesComponent\"\nexport * from \"./breadcrumbComponent\"\n","import { ErrorPayload, SyncerPayloadType } from \".\"\n\nexport interface GapiErrorResponseBody {\n    code: number,\n    message: string,\n    status: string\n}\n\nexport interface GapiErrorResponse {\n    error: GapiErrorResponseBody\n}\n\nexport class SyncerError extends Error {\n    public payload: ErrorPayload\n\n    constructor(errorMsg: string, public friendlyMsg: string, public needsReAuth: boolean, pause?: boolean) {\n        super(errorMsg)\n        this.payload = {\n            pause: (pause !== undefined) ? pause : true,\n            error: this,\n            friendlyMsg: this.friendlyMsg,\n            type: SyncerPayloadType.ERROR,\n        }\n    }\n}\n","export enum SearchType {\n    NONE,\n    AND,\n    OR,\n}\n","export enum TestMode {\n    OFF = \"0\",\n    WORKING = \"1\",\n    FAIL_GET_SPREADSHEET_SHEETS = \"2\",\n    FAIL_GET_RANGE = \"3\",\n    FAIL_UPDATE_RANGE = \"4\",\n    FAIL_DELETE_ROW = \"5\",\n    RETURN_ROWS = \"6\",\n    DEMO = \"7\"\n}\n","import { TestMode } from \"./testing\"\n\nexport type SyncerPayload = (\n    GetRowsPayload | GetSheetsPayload | GetSpreadsheetPayload | UpdateRowPayload |\n    ExtendSheetPayload | DeleteRowPayload | TestModeUpdatePayload | AuthUpdatePayload |\n    UnpausePayload | SyncStatePayload | ErrorPayload | TokenRequestPayload\n)\n\nexport enum SyncerPayloadType {\n    AUTH_UPDATE,\n    DELETE_ROW,\n    UPDATE_ROW,\n    GET_ROWS,\n    GET_SHEETS,\n    TEST_MODE_UPDATE,\n    UNPAUSE,\n    GET_SPREADSHEET,\n    EXTEND_SHEET,\n    CREATE_ROW,\n    MOVE_ROW,\n    ERROR,\n    TOKEN_REQUEST,\n    SYNC_STATE,\n}\n\nexport enum SyncerResponseType {\n    SYNCER_STATE,\n    ERROR,\n    REAUTH,\n}\n\nexport enum SyncerState {\n    PAUSED = \"cloud_off\",\n    UPLOADING = \"cloud_upload\",\n    DOWNLOADING = \"cloud_download\",\n    SYNCED = \"cloud_done\",\n}\n\nexport interface TestModeUpdatePayload {\n    type: SyncerPayloadType.TEST_MODE_UPDATE\n    testMode: TestMode\n}\n\nexport interface AuthUpdatePayload {\n    type: SyncerPayloadType.AUTH_UPDATE\n    token: string\n}\n\nexport interface UnpausePayload {\n    type: SyncerPayloadType.UNPAUSE\n}\n\nexport interface DeleteRowPayload {\n    type: SyncerPayloadType.DELETE_ROW\n    idx: number\n    spreadsheetId: string\n    sheetId: number\n}\n\nexport interface ExtendSheetPayload {\n    type: SyncerPayloadType.EXTEND_SHEET\n    spreadsheetId: string\n    sheetId: number\n}\n\nexport interface UpdateRowPayload {\n    type: SyncerPayloadType.UPDATE_ROW\n    idx: number\n    spreadsheetId: string\n    sheetId: number\n    sheetTitle: string\n    content: string\n}\n\nexport interface GetSpreadsheetPayload {\n    type: SyncerPayloadType.GET_SPREADSHEET\n    spreadsheetId: string\n    spreadsheet?: gapi.client.sheets.Spreadsheet\n}\n\nexport interface GetRowsPayload {\n    type: SyncerPayloadType.GET_ROWS\n    spreadsheetId: string\n    sheetId: number\n    sheetTitle: string\n    rows: string[]\n}\n\nexport interface GetSheetsPayload {\n    type: SyncerPayloadType.GET_SHEETS\n    spreadsheetId: string\n    sheets: gapi.client.sheets.Sheet[]\n}\n\nexport interface SyncStatePayload {\n    type: SyncerPayloadType.SYNC_STATE\n    length: number\n    state: SyncerState\n}\n\nexport interface ErrorPayload {\n    type: SyncerPayloadType.ERROR\n    error: Error\n    pause: boolean\n    friendlyMsg: string\n}\n\nexport interface TokenRequestPayload {\n    type: SyncerPayloadType.TOKEN_REQUEST\n}\n","export * from \"./shelfView\"\r\nexport * from \"./signinView\"\r\nexport * from \"./libraryView\"\r\nexport * from \"./journalView\"\r\n","import m from \"mithril\"\nimport { googleComponent, journalsComponent, syncStateComponent, breadcrumbComponent } from \"./components\"\n\nexport function shelfView() {\n\n    function view() {\n        return m(\"#shelf\", [\n            m(breadcrumbComponent),\n            m(googleComponent),\n            m(syncStateComponent),\n            m(journalsComponent),\n        ])\n    }\n\n    return {\n        view: view\n    }\n\n}","import m from \"mithril\"\nimport { googleModel } from \"../..\"\nimport { googleController } from \"../../controllers\"\n\nexport function googleComponent() {\n\n    function view() {\n        return m(\"#googleApi\", [\n            preambleMessage(),\n            signInOutButton(),\n            m(\"script\", gapiScriptSettings()),\n        ])\n    }\n\n    function gapiScriptSettings() {\n        return {\n            async: true,\n            defer: true,\n            src: googleModel.src,\n            onload: () => {\n                if (!googleModel.isSignedIn) {\n                    googleController.initGapi()\n                }\n            }\n        }\n    }\n\n    function signInOutButton() {\n        return (googleModel.isSignedIn)\n            ? m(\"button\", { onclick: () => googleController.signOut(), class: \"authButton\" }, \"Sign Out\")\n            : m(\"button\", { onclick: () => googleController.signIn(), class: \"authButton\" }, \"Sign In\")\n    }\n\n    function preambleMessage() {\n        return (googleModel.isSignedIn !== undefined && !googleModel.isSignedIn)\n            ? m(\".preamble\", \"PREAMBLE MSG\") // TODO: fill out\n            : null\n    }\n\n    return { view: view }\n}\n","import m from \"mithril\"\r\nimport { googleModel } from \"..\"\r\nimport { MockGapi } from \"../mocks\"\r\nimport { TestMode } from \"../types\"\r\nimport { getTestMode } from \"../helpers\"\r\nimport { syncerController, libraryController } from \"../controllers\"\r\n\r\nexport const googleController = {\r\n    signIn: signIn,\r\n    signOut: signOut,\r\n    initGapi: initGapi,\r\n}\r\n\r\nfunction signOut() {\r\n    googleModel.gapi_!.auth2.getAuthInstance().signOut()\r\n}\r\n\r\nfunction signIn() {\r\n    googleModel.gapi_!.auth2.getAuthInstance().signIn()\r\n}\r\n\r\nfunction initGapi() {\r\n    let gapi_ = (getTestMode() === TestMode.OFF) ? gapi : new MockGapi()\r\n    googleModel.gapi_ = gapi_\r\n    googleModel.gapi_.load('auth2', () => {\r\n        googleModel.gapi_!.auth2.init({\r\n            scope: googleModel.scope, client_id: googleModel.clientId\r\n        }).then(() => {\r\n            googleModel.gapi_!.auth2.getAuthInstance().isSignedIn.listen(isSignedIn)\r\n            isSignedIn((googleModel.gapi_!.auth2.getAuthInstance().isSignedIn.get()))\r\n        })\r\n    })\r\n\r\n}\r\n\r\nasync function isSignedIn(signedIn: boolean) {\r\n    googleModel.isSignedIn = signedIn\r\n    if (googleModel.isSignedIn) {\r\n        googleModel.user = googleModel.gapi_!.auth2.getAuthInstance().currentUser.get()\r\n        syncerController.updateAuth(googleModel.token)\r\n        libraryController.loadShelves()\r\n    } else {\r\n        libraryController.removeShelves()\r\n    }\r\n    m.redraw()\r\n\r\n    // if (getTestMode() === TestMode.DEMO) {\r\n    //     journal.isSignedIn = true\r\n    //     journal.load(\"https://docs.google.com/spreadsheets/d/demo/edit\")\r\n    //     return []\r\n    // }\r\n}\r\n","export * from \"./Gapi\"\n","export class MockGapi {\n    public auth2 = new MockAuth2()\n    public load(_api: string, _callback: () => void) {\n        _callback()\n    }\n}\n\nclass MockAuth2 {\n    public getAuthInstance() {\n        return new MockGoogleAuth()\n    }\n    public async init(_params: any) { }\n}\n\nclass MockCurrentUser {\n    public get() { return new MockGoogleUser() }\n}\n\nexport class MockGoogleUser {\n    public getAuthResponse() {\n        return {\n            expires_in: 9999,\n            access_token: \"faketoken\"\n        }\n    }\n    public async reloadAuthResponse() {\n        return {\n            expires_in: 9999,\n            access_token: \"faketoken\"\n        }\n    }\n}\n\nclass MockGoogleAuth {\n    public isSignedIn = new MockIsSignedIn()\n    public signOut() { }\n    public signIn() { }\n    public currentUser = new MockCurrentUser()\n}\n\nclass MockIsSignedIn {\n    public listen = (_callback: any) => { }\n    public get = () => { return true }\n}\n","import { TestMode } from \"../types\"\n\nexport function getHash(): string {\n    let url = new URL(window.location.href)\n    return url.hash\n}\n\nexport function getTestMode(): TestMode {\n    let url = new URL(window.location.href)\n    if (url.hash === \"#!demo\") {\n        return TestMode.DEMO\n    }\n    let test = url.searchParams.get(\"test\")\n    return (test !== null && instanceOfTestMode(test)) ? test : TestMode.OFF\n\n}\n\nfunction instanceOfTestMode(str: string): str is TestMode {\n    return ((<any>Object).values(TestMode).includes(str))\n}\n","import m from \"mithril\"\n\nexport class FriendlyError extends Error {\n    constructor(errorMsg: string, public friendlyMsg: string) {\n        super(errorMsg)\n        console.warn(errorMsg)\n        // journal.errors.push(friendlyMsg) // TODO reassign\n        m.redraw()\n    }\n}\n","export function escapeHtml(unsafe: string): string {\n    return unsafe\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n}\n","function node_walk(node: any, func: any): void {\n    var result = func(node)\n    for (node = node.firstChild; result !== false && node; node = node.nextSibling)\n        result = node_walk(node, func)\n    return\n}\n\nexport function getCaretPosition(elem: any) {\n    var sel: any = window.getSelection()\n    var cum_length = [0, 0]\n\n    if (sel.anchorNode == elem) {\n        cum_length = [sel.anchorNode.innerText.length, sel.extentNode.innerText.length]\n    } else {\n        var nodes_to_find = [sel.anchorNode, sel.extentNode]\n        if (!elem.contains(sel.anchorNode) || !elem.contains(sel.extentNode)) {\n            return undefined\n        } else {\n            var found = [0, 0]\n            var i\n            node_walk(elem, function (node: any): void {\n                for (i = 0; i < 2; i++) {\n                    if (node == nodes_to_find[i]) {\n                        found[i] = 1\n                        if (found[i == 0 ? 1 : 0]) {\n                            return\n                        }\n                    }\n                }\n                if (node.textContent && !node.firstChild) {\n                    for (i = 0; i < 2; i++) {\n                        if (!found[i]) {\n                            cum_length[i] += node.textContent.length\n                        }\n                    }\n                }\n            })\n            cum_length[0] += sel.anchorOffset\n            cum_length[1] += sel.extentOffset\n        }\n    }\n    if (cum_length[0] <= cum_length[1]) {\n        return cum_length\n    }\n    return [cum_length[1], cum_length[0]]\n}\n\nexport function setCaretPosition(el: any, pos: any): any {\n    if (el !== null && pos !== null) {\n        for (var node of el.childNodes) {\n            if (node.nodeType == 3) {\n                if (node.length >= pos) {\n                    let range = document.createRange()\n                    let sel: any = window.getSelection()\n                    range.setStart(node, pos)\n                    range.collapse(true)\n                    sel.removeAllRanges()\n                    sel.addRange(range)\n                    return -1\n                } else {\n                    pos -= node.length\n                }\n            } else {\n                pos = setCaretPosition(node, pos)\n                if (pos == -1) {\n                    return -1\n                }\n            }\n        }\n        return pos\n    }\n}\n","export const tagPattern = /(\\@)([\\w-']+)+(:)?([\\w-'\\*]+)?/g\n","import m from \"mithril\"\r\nimport { FriendlyError } from \"../helpers\"\r\nimport { googleModel, syncerModel } from \"..\"\r\nimport { SyncerPayloadType, TestMode, SyncerPayload, ErrorPayload } from \"../types\"\r\n\r\nconst worker = new Worker(\"./js/syncWebWorker.js\")\r\nworker.onmessage = (msg: MessageEvent) => onMessage(msg)\r\n\r\nexport const syncerController = {\r\n    unpause: unpause,\r\n    getRows: getRows,\r\n    deleteRow: deleteRow,\r\n    updateRow: updateRow,\r\n    getSheets: getSheets,\r\n    updateAuth: updateAuth,\r\n    updateTestMode: updateTestMode,\r\n    getSpreadsheet: getSpreadsheet,\r\n}\r\n\r\nasync function updateTestMode(testMode: TestMode) {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.TEST_MODE_UPDATE,\r\n        testMode: testMode,\r\n    }, worker)\r\n}\r\n\r\nfunction updateAuth(token: string | undefined) {\r\n    if (token === undefined) return\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.AUTH_UPDATE,\r\n        token: token,\r\n    }, worker)\r\n}\r\n\r\nfunction getSpreadsheet(spreadsheetId: string) {\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.GET_SPREADSHEET,\r\n        spreadsheetId: spreadsheetId,\r\n        spreadsheet: undefined\r\n    }, worker)\r\n}\r\n\r\nfunction getSheets(spreadsheetId: string) {\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.GET_SHEETS,\r\n        spreadsheetId: spreadsheetId,\r\n        sheets: []\r\n    }, worker)\r\n}\r\n\r\nfunction getRows(spreadsheetId: string, sheetId: number, sheetTitle: string) {\r\n    return syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.GET_ROWS,\r\n        spreadsheetId: spreadsheetId,\r\n        sheetTitle: sheetTitle,\r\n        sheetId: sheetId,\r\n        rows: []\r\n    }, worker)\r\n}\r\n\r\nasync function deleteRow(idx: number, spreadsheetId: string, sheetId: number) {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.DELETE_ROW,\r\n        spreadsheetId: spreadsheetId,\r\n        sheetId: sheetId,\r\n        idx: idx,\r\n    }, worker)\r\n}\r\n\r\nasync function updateRow(idx: number, spreadsheetId: string, sheetId: number, sheetTitle: string, content: string) {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.UPDATE_ROW,\r\n        spreadsheetId: spreadsheetId,\r\n        sheetTitle: sheetTitle,\r\n        sheetId: sheetId,\r\n        content: content,\r\n        idx: idx,\r\n    }, worker)\r\n}\r\n\r\nasync function unpause() {\r\n    return await syncerModel.pushSyncerTask({\r\n        type: SyncerPayloadType.UNPAUSE\r\n    }, worker)\r\n}\r\n\r\nfunction onMessage(msg: MessageEvent) {\r\n    let { id, payload, error }: { id: string | null, payload: SyncerPayload, error: ErrorPayload } = msg.data\r\n    if (id !== null && syncerModel.requests.has(id)) {\r\n        syncerModel.requests.get(id)!({ payload, error })\r\n        syncerModel.requests.delete(id)\r\n    } else {\r\n        switch (payload.type) {\r\n            case SyncerPayloadType.SYNC_STATE:\r\n                syncerModel.state = payload.state\r\n                m.redraw()\r\n                break\r\n            case SyncerPayloadType.ERROR:\r\n                new FriendlyError(payload.error.message, payload.friendlyMsg)\r\n                break\r\n            case SyncerPayloadType.TOKEN_REQUEST:\r\n                updateAuth(googleModel.token)\r\n                break\r\n        }\r\n    }\r\n}\r\n\r\n","import m from \"mithril\"\nimport { libraryModel } from \"..\"\nimport { ErrorPayload } from \"../types\"\nimport { ShelfFactory } from \"../models\"\nimport { FriendlyError } from \"../helpers\"\nimport { syncerController } from \"../controllers\"\n\nconst shelfFactory = new ShelfFactory()\nconst spreadsheetIdPattern = /\\/spreadsheets\\/d\\/([a-zA-Z0-9-_]+)/g\n\nexport const libraryController = {\n    addShelves: addShelves,\n    removeShelves: removeShelves,\n    loadShelves: loadShelves,\n    getSpreadsheetIdsFromUrls: getSpreadsheetIdsFromUrls,\n}\n\nfunction addShelves(urls: string) {\n    let ids = getSpreadsheetIdsFromUrls(urls)\n    ids = ids.filter(id => !libraryModel.shelves.has(id))\n    ids.forEach(id => libraryModel.shelves.set(id, undefined))\n    libraryModel.shelfIds = Array.from(libraryModel.shelves.keys())\n    loadShelves(false, ids)\n}\n\nfunction removeShelves(ids?: string[]) {\n    if (ids === undefined) ids = Array.from(libraryModel.shelves.keys())\n    ids = ids.filter(id => libraryModel.shelves.has(id))\n    ids.forEach(id => libraryModel.shelves.delete(id))\n    libraryModel.shelfIds = Array.from(libraryModel.shelves.keys())\n}\n\nfunction loadShelves(reloadLoaded?: boolean, ids?: string[]) {\n    if (ids === undefined) ids = Array.from(libraryModel.shelves.keys())\n    if (reloadLoaded) {\n        ids.forEach(id => libraryModel.shelves.set(id, undefined))\n        m.redraw()\n    }\n    ids.filter(id => !libraryModel.shelves.get(id))\n        .forEach(id => syncerController.getSpreadsheet(id)\n        .then(payload => {\n            let shelf = shelfFactory.createShelf(id, payload.spreadsheet)\n            libraryModel.shelves.set(shelf.id, shelf)\n        })\n        .catch((error: ErrorPayload) => {\n            new FriendlyError(error.error.message, error.friendlyMsg)\n            let shelf = shelfFactory.createShelf(id, undefined, error.friendlyMsg)\n            libraryModel.shelves.set(id, shelf)\n        })\n        .finally(() => {\n            m.redraw()\n        })\n    )\n}\n\nfunction getSpreadsheetIdsFromUrls(urls: string | undefined): string[] {\n    let ids: string[] = []\n    if (urls) {\n        Array.from(urls.matchAll(spreadsheetIdPattern)).forEach(m => ids.push(m[1]))\n    }\n    return ids\n}\n","import { escapeHtml } from \"../helpers\"\n\nexport class TagModel {\n    public frq: number\n    public raw: string\n    public key: string\n    public flag: string\n    public clean: string\n    public cleanKey: string\n    public val: string | null\n    public cleanVal: string | null\n    public separator: string | null\n\n    constructor(raw: string, flag: string, key: string, separator: string | undefined | null, val: string | undefined | null) {\n        this.frq = 1\n        this.raw = raw\n        this.flag = flag\n        this.key = key\n        this.separator = (separator !== undefined) ? separator : null\n        this.val = (val !== undefined) ? val : null\n        this.clean = this.cleanTagString(this.raw)\n        this.cleanKey = this.cleanTagString(this.key)\n        this.cleanVal = (this.val !== null) ? this.cleanTagString(this.val) : null\n    }\n\n    public renderKey(): string {\n        return \"<span onclick=\\\"tagOnClick(event, '\"\n            + this.flag\n            + this.cleanKey\n            + ((this.separator) ? this.separator : \"\")\n            + \"')\\\" class=\\\"\"\n            + ((this.separator) ? \"tagKey\" : (this.val === null) ? \"simpleTag\" : \"roundTagVal\")\n            + \"\\\">\"\n            + this.flag\n            + this.key\n            + \"</span>\"\n    }\n\n    public renderVal(hideKeys?: boolean): string {\n        return \"<span onclick=\\\"tagOnClick(event, '\"\n            + this.flag\n            + this.cleanKey\n            + this.separator\n            + this.cleanVal?.replace(/'/, \"\\\\'\")\n            + \"')\\\" class=\\\"\"\n            + ((hideKeys) ? \"roundTagVal\" : \"tagVal\")\n            + \"\\\">\"\n            + ((hideKeys) ? \"\" : this.separator)\n            + (this.val || \"\")\n            + \"</span>\"\n    }\n\n    public render(hideKeys?: boolean): string {\n        if (this.separator) {\n            return (hideKeys) ? this.renderVal(hideKeys) : this.renderKey() + this.renderVal(hideKeys)\n        } else {\n            return this.renderKey()\n        }\n    }\n\n    private cleanTagString(str: string) {\n        str = escapeHtml(str)\n        str = (str.endsWith(\"'s\")) ? str.substring(0, str.length - 2) : str\n        str = str.toLowerCase()\n        return str\n    }\n}\n","import { TagModel } from \".\"\nimport { tagPattern, escapeHtml } from \"../helpers\"\n\nexport type TagsMap = Map<string, TagModel>\n\ninterface TagMatch {\n    tag: TagModel,\n    match: RegExpMatchArray\n}\n\nexport interface IndexedEntry {\n    idx: number,\n    entry: EntryModel,\n}\n\nexport class EntryModel {\n    public tags: TagsMap = new Map()\n    public hovered: boolean = false\n    public focused: boolean = false\n    public clean: string = \"\"\n    public tokens: string[] = []\n    public rendered: string = \"\"\n    public savedClean: string = \"\"\n    private tagMatches: TagMatch[] = []\n    public readableRendered: string = \"\"\n    private rawText: string = \"\"\n    private savedText: string = \"\"\n\n    constructor(raw?: string | undefined, saved?: string | undefined) {\n        this.raw = (raw) ? raw : \"\"\n        this.saved = (saved !== undefined) ? saved : this.raw\n    }\n\n    public get saved(): string {\n        return this.savedText\n    }\n    public set saved(str: string) {\n        this.savedText = str\n        this.savedClean = str.toLowerCase()\n        this.tags = this.getTags(this.tagMatches)\n    }\n\n    public get raw(): string {\n        return this.rawText\n    }\n    public set raw(raw: string) {\n        this.rawText = raw\n        this.clean = this.raw.toLowerCase()\n        let safe = escapeHtml(this.rawText)\n        this.tokens = this.getTokens(this.clean)\n        this.tagMatches = this.getTagMatches(safe)\n        this.rendered = this.render(safe, this.tagMatches)\n        this.readableRendered = this.render(safe, this.tagMatches, true)\n    }\n\n    private render(text: string, tagMatches: TagMatch[], hideKeys?: boolean): string {\n        for (let { tag, match } of tagMatches) {\n            let chars = text.split(\"\")\n            chars.splice(match.index!, match[0].length, tag.render(hideKeys))\n            text = chars.join(\"\")\n        }\n        return text\n    }\n\n    private getTags(tagMatches: TagMatch[]): TagsMap {\n        let tags: TagsMap = new Map()\n        for (let { tag } of tagMatches) {\n            if (tags.has(tag.clean)) {\n                tags.get(tag.clean)!.frq += 1\n            } else {\n                tags.set(tag.clean, tag)\n            }\n        }\n        return tags\n    }\n\n    private getTagMatches(text: string): TagMatch[] {\n        let tagMatches = []\n        let matchesIter = text.matchAll(tagPattern)\n        for (let match of matchesIter) {\n            let tag = new TagModel(match[0], match[1], match[2], match[3], match[4])\n            tagMatches.push({ tag: tag, match: match })\n        }\n        tagMatches.sort((a, b) => (a.match.index! > b.match.index!) ? -1 : 1)\n        return tagMatches\n    }\n\n    private getTokens(text: string): string[] {\n        let tokens = text.split(\" \")\n        return tokens.filter(token => {\n            return token !== undefined && token.trim() !== \"\" && token !== \"-\"\n        })\n    }\n\n}\n","import { JournalFactory, JournalModel } from \".\"\n\nexport class ShelfFactory {\n\n    private journalFactory = new JournalFactory()\n\n    public createShelf(spreadsheetId: string, spreadsheet?: gapi.client.sheets.Spreadsheet, error?: string) {\n        if (\n            spreadsheet !== undefined &&\n            spreadsheet.spreadsheetId !== undefined &&\n            spreadsheet.properties !== undefined &&\n            spreadsheet.properties.title !== undefined &&\n            spreadsheet.sheets !== undefined\n        ) {\n            let journals = this.getJournals(spreadsheet.spreadsheetId, spreadsheet.sheets)\n            return new ShelfModel(spreadsheet.spreadsheetId, spreadsheet.properties.title, journals)\n        }\n        return new ShelfModel(spreadsheetId, undefined, undefined, error)\n    }\n\n    private getJournals(spreadsheetId: string, sheets: gapi.client.sheets.Sheet[]) {\n        let journals: JournalModel[] = []\n        sheets.forEach(sheet => {\n            if (\n                sheet.properties !== undefined &&\n                sheet.properties.title !== undefined &&\n                sheet.properties.sheetId !== undefined\n            ) {\n                let journal = this.journalFactory.createJournal(\n                    sheet.properties.sheetId, spreadsheetId, sheet.properties.title\n                )\n                if (journal === undefined) return\n                journals.push(journal)\n            }\n        })\n        return journals\n    }\n\n}\n\nexport class ShelfModel {\n    public id: string\n    public error: string | undefined\n    public title: string | undefined\n    public journals: Map<number, JournalModel> = new Map()\n\n    constructor(id: string, title?: string, journals?: JournalModel[], error?: string) {\n        this.id = id\n        this.error = error\n        this.title = title\n        if (journals !== undefined) this.addJournals(journals)\n    }\n\n    public addJournals(journals: JournalModel[]) {\n        journals.filter(journal => !this.journals.has(journal.id))\n            .forEach(journal => this.journals.set(journal.id, journal))\n    }\n}\n","import { SyncerState, SyncerPayload, ErrorPayload } from \"../types\"\r\n\r\nexport class SyncerModel {\r\n    public requestsCounter: number\r\n    public requests: Map<string, Function>\r\n    public state: SyncerState\r\n\r\n    constructor() {\r\n        this.requestsCounter = 0\r\n        this.requests = new Map()\r\n        this.state = SyncerState.SYNCED\r\n    }\r\n\r\n    public pushSyncerTask<P extends SyncerPayload>(payload: P, worker: Worker): Promise<P> {\r\n        let id = `payload-${this.requestsCounter++}`\r\n        return new Promise((resolve, reject) => {\r\n            this.requests.set(id, ({ payload, error }: { payload: P, error: ErrorPayload }) => {\r\n                (error) ? reject(error) : resolve(payload)\r\n            })\r\n            worker.postMessage({ id, payload })\r\n        })\r\n    }\r\n\r\n}\r\n","import { MockGapi, MockGoogleUser } from \"../mocks\"\n\nexport class GoogleModel {\n    public src: string\n    public scope: string\n    public clientId: string\n    public isSignedIn: boolean | undefined\n    public gapi_: MockGapi | typeof gapi | undefined\n    public user: gapi.auth2.GoogleUser | MockGoogleUser | undefined\n\n    constructor(isSignedIn?: boolean) {\n        this.isSignedIn = isSignedIn\n        this.src = \"https://apis.google.com/js/api.js\"\n        this.scope = [\n            \"https://www.googleapis.com/auth/spreadsheets\"\n        ].join(\" \")\n        this.clientId = \"893904323330-moo1k9s19qp40kr747pftdo29ejdef0o.apps.googleusercontent.com\"\n    }\n\n    get token(): string | undefined {\n        if (!this.user) return\n        let auth = this.user.getAuthResponse()\n        return auth.access_token\n    }\n}\n","import { EntryModel, TagsMap, TagModel } from \".\"\n\nexport class JournalFactory {\n    public createJournal(id: number, shelfId: string, title: string) {\n        return new JournalModel(id, shelfId, title)\n    }\n}\n\nexport class JournalModel {\n    public id: number\n    public tags: TagsMap\n    public title: string\n    public shelfId: string\n    public entries: EntryModel[] = []\n\n    constructor(id: number, shelfId: string, title: string) {\n        this.id = id\n        this.title = title\n        this.tags = new Map()\n        this.shelfId = shelfId\n    }\n\n    private buildTags(): TagsMap {\n        let tags: TagsMap = new Map()\n        for (let entry of Array.from(this.entries.values()).reverse()) {\n            for (let [key, tag] of entry.tags) {\n                if (tags.has(key)) {\n                    tags.get(key)!.frq += tag.frq\n                } else {\n                    tags.set(key, new TagModel(tag.raw, tag.flag, tag.key, tag.separator, tag.val))\n                }\n            }\n        }\n        return tags\n    }\n\n    public addEntry(idx: number, content: string) {\n        this.entries.splice(idx, 0, new EntryModel(content))\n        this.tags = this.buildTags()\n    }\n\n    public updateEntry(idx: number, content: string) {\n        let entry = this.entries[idx]\n        if (entry.saved === content) { return }\n        entry.saved = content\n        this.tags = this.buildTags()\n    }\n\n    public deleteEntry(idx: number) {\n        this.entries.splice(idx, 1)[0]\n        this.tags = this.buildTags()\n    }\n\n    public moveEntry(fromIdx: number, toIdx: number) {\n        let entry = this.entries[fromIdx]\n        this.entries.splice(fromIdx, 1)\n        this.entries.splice(toIdx, 0, entry)\n    }\n\n}\n","import { ShelfModel } from \".\"\n\nexport class LibraryModel {\n    public shelves: Map<string, ShelfModel | undefined>\n\n    public x = { id: \"h\", shelf: undefined }\n\n    constructor() {\n        this.shelves = new Map()\n        this.shelfIds.forEach(id => this.shelves.set(id, undefined))\n    }\n\n    set shelfIds(ids: string[]) {\n        localStorage.setItem(\"spreadsheetIds\", ids.join(\",\"))\n    }\n    get shelfIds(): string[] {\n        let ids = localStorage.getItem(\"spreadsheetIds\")\n        return (ids === null) ? [] : ids.split(\",\")\n    }\n\n}\n","import { FriendlyError } from \"../helpers\"\n\nexport class ServiceWorkerModel {\n    constructor() {\n        if (\"serviceWorker\" in navigator) {\n            window.addEventListener(\"load\", async () => {\n                await navigator.serviceWorker.register(\"../serviceWorker.js\")\n            })\n        } else {\n            throw new FriendlyError(\"serviceWorker not supported\", \"Your browser is not supported.\")\n        }\n    }\n}\n","export const storageController = {\n    setSpreadsheetId: setSpreadsheetId,\n    getSpreadsheetId: getSpreadsheetId,\n    getSpreadsheetSheetId: getSpreadsheetSheetId,\n    setSpreadsheetSheetId: setSpreadsheetSheetId,\n    delSpreadsheetSheetId: delSpreadsheetSheetId,\n}\n\nfunction setSpreadsheetId(id: string) {\n    localStorage.setItem(\"spreadsheetId\", id)\n}\nfunction getSpreadsheetId(): string | undefined {\n    return localStorage.getItem(\"spreadsheetId\") || undefined\n}\n\nfunction getSpreadsheetSheetId(spreadsheetId: string | undefined): number | undefined {\n    let sheetId = localStorage.getItem(`${spreadsheetId}-sheetId`) || undefined\n    return (sheetId !== undefined) ? parseInt(sheetId) : undefined\n}\nfunction setSpreadsheetSheetId(spreadsheetId: string, sheetId: number) {\n    localStorage.setItem(`${spreadsheetId}-sheetId`, sheetId.toString())\n}\nfunction delSpreadsheetSheetId(spreadsheetId: string | undefined) {\n    localStorage.removeItem(`${spreadsheetId}-sheetId`)\n}\n","import m from \"mithril\"\nimport { libraryModel } from \"../..\"\nimport { ShelfModel } from \"../../models\"\nimport { libraryController } from \"../../controllers\"\n\nexport function shelvesComponent() {\n\n    function view() {\n        let shelves = Array.from(libraryModel.shelves.entries())\n        return m(\"#shelvesList\", shelves.map(([id, shelf]) => shelfNode(id, shelf)))\n    }\n\n    function delShelfButton(id: string) {\n        return m(\"button\", {\n            class: \"del\",\n            onclick: () => libraryController.removeShelves([id])\n        }, \"del\")\n    }\n\n    function retryShelfLoadButton(id: string) {\n        return m(\"button\", {\n            onclick: () => libraryController.loadShelves(true, [id])\n        }, \"retry\")\n    }\n\n    function shelfNode(id: string, shelf: ShelfModel | undefined) {\n        if (shelf === undefined) {\n            return m(\"li\", [\n                delShelfButton(id),\n                m(\"span\", id)\n            ])\n        } else if (shelf.error !== undefined) {\n            return m(\"li\", [\n                delShelfButton(id),\n                m(\"span\", `${id} ${shelf.error}`),\n                retryShelfLoadButton(id)\n            ])\n        } else {\n            return m(\"li\", [\n                delShelfButton(id),\n                m(\"a\", { href: `#/library/${id}` }, shelf.title)\n            ])\n        }\n    }\n\n    return {\n        view: view,\n    }\n\n}","import m from \"mithril\"\nimport { libraryModel } from \"../..\"\n\nexport function journalsComponent() {\n\n    function view() {\n        return m(\"#journals\", journalList())\n    }\n\n    function journalList() {\n        let shelf = libraryModel.shelves.get(m.route.param(\"shelfId\"))\n        if (shelf === undefined) return\n        return Array.from(shelf.journals.values()).map(journal => {\n            let link = `#/library/${journal.shelfId}/${journal.id}`\n            return m(\"li\", m(\"a\", { href: link }, journal.title))\n        })\n    }\n\n    return {\n        view: view,\n    }\n\n}","import m from \"mithril\"\nimport { syncerModel } from \"../../\"\nimport { SyncerState } from \"../../types\"\nimport { syncerController } from \"../../controllers\"\n\nexport function syncStateComponent() {\n\n    function view() {\n        return m(\"#status\", m(\"span\", syncState()))\n    }\n\n    function syncState() {\n        return m(\"span\", [\n            syncStateIcon(),\n            syncStateText(),\n            unpauseSync()\n        ])\n    }\n\n    function syncStateText() {\n        let txt = \"\"\n        let class_ = `syncState ${stateColorClass()}`\n\n        switch (syncerModel.state) {\n            case SyncerState.DOWNLOADING:\n                txt = \"Downloading journal data from drive...\"\n                break\n            case SyncerState.PAUSED:\n                txt = \"Warning! - Syncing is paused.\"\n                break\n            case SyncerState.SYNCED:\n                txt = \"All changes saved.\"\n                break\n            case SyncerState.UPLOADING:\n                txt = \"Uploading changes to drive...\"\n                break\n        }\n        return m(\"span\", { id: \"syncStateText\", class: class_ }, txt)\n    }\n\n    function syncStateIcon() {\n        let class_ = `material-icons material-icons-outlined syncState ${stateColorClass()}`\n        return m(\"i\", { id: \"syncStateIcon\", class: class_ }, syncerModel.state)\n    }\n\n    function unpauseSync() {\n        if (syncerModel.state === SyncerState.PAUSED) {\n            return m(\"button\", {\n                id: \"unpauseSync\",\n                class: \"syncState\",\n                onclick: () => syncerController.unpause()\n            }, \"Unpause Syncing\")\n        }\n        return\n    }\n\n    function stateColorClass() {\n        switch (syncerModel.state) {\n            case SyncerState.PAUSED:\n                return \"error\"\n            case SyncerState.SYNCED:\n                return \"okay\"\n            default:\n                return \"warn\"\n        }\n    }\n\n    return { view: view }\n}\n","import m from \"mithril\"\r\nimport { libraryController } from \"../../controllers\"\r\n\r\nexport function addShelvesComponent() {\r\n\r\n    let newShelfUrls = \"\"\r\n    let addingShelves = false\r\n\r\n    function view() {\r\n        return m(\"#addShelves\", [\r\n            addShelvesButton(),\r\n            addShelvesTextbox(),\r\n        ])\r\n    }\r\n\r\n    function addShelvesButton() {\r\n        return m(\"button\", {\r\n            id: \"addShelvesButton\",\r\n            onclick: async () => {\r\n                if (addingShelves) libraryController.addShelves(newShelfUrls)\r\n                newShelfUrls = \"\"\r\n                addingShelves = !addingShelves\r\n            }\r\n        }, (addingShelves) ? \"  \" : \"+/-\")\r\n    }\r\n\r\n    function addShelvesTextbox() {\r\n        if (!addingShelves) return null\r\n        return m(\"textarea\", {\r\n            id: \"addShelvesText\",\r\n            placeholder: \"Enter list of Google Sheets Spreadsheet URLs here\",\r\n            oninput: (event: any) => newShelfUrls = event.target.value\r\n        })\r\n    }\r\n\r\n    return {\r\n        view: view,\r\n    }\r\n\r\n}","import m from \"mithril\"\nimport { getHash } from \"../../helpers\"\nimport { libraryModel } from \"../..\"\n\nexport function breadcrumbComponent() {\n\n    function view() {\n        return m(\"#breadcrumb\", breadcrumbs())\n    }\n\n    function breadcrumbs() {\n        let breadcrumb: m.Vnode[] = []\n        let hash = getHash().split(\"/\").filter(crumb => crumb !== \"#\" && crumb !== \"\")\n        let shelfId: string | undefined = undefined\n        for (let i = 0; i < hash.length; i++) {\n            let crumb = hash[i]\n            let trail = \"#/\" + hash.slice(0, i + 1).join(\"/\")\n            if (i === 1) {\n                shelfId = crumb\n                crumb = libraryModel.shelves.get(crumb)?.title || crumb\n            } else if (i === 2 && shelfId !== undefined) {\n                crumb = libraryModel.shelves.get(shelfId)?.journals.get(parseInt(crumb))?.title || crumb\n            }\n            breadcrumb.push(m(\"span\", \" / \"))\n            if (i === hash.length - 1) {\n                breadcrumb.push(m(\"span\", `${crumb}`))\n            } else {\n                breadcrumb.push(m(\"a\", { href: trail }, `${crumb}`))\n            }\n        }\n        return breadcrumb\n    }\n\n    return {\n        view: view,\n    }\n\n}","import m from \"mithril\"\r\nimport { googleModel } from \"..\"\r\nimport { googleComponent } from \"./components\"\r\n\r\nexport function signinView() {\r\n\r\n    function view() {\r\n        return m(\"#auth\", [\r\n            m(googleComponent),\r\n        ])\r\n    }\r\n\r\n    function onupdate() {\r\n        if (googleModel.isSignedIn) {\r\n            window.location.hash = \"/library\" // TODO: redirect to correct place\r\n        }\r\n    }\r\n\r\n    return {\r\n        view: view,\r\n        onupdate: onupdate,\r\n    }\r\n\r\n}","import m from \"mithril\"\nimport { \n    googleComponent, shelvesComponent, syncStateComponent, addShelvesComponent\n} from \"./components\"\n\nexport function libraryView() {\n\n    function view() {\n        return m(\"#library\", [\n            m(googleComponent),\n            m(syncStateComponent),\n            m(addShelvesComponent),\n            m(shelvesComponent),\n        ])\n    }\n\n    return {\n        view: view\n    }\n\n}","import m from \"mithril\"\nimport { libraryModel } from \"..\"\nimport { googleComponent, breadcrumbComponent } from \"./components\"\n\nexport function journalView() {\n\n    function view() {\n        let shelf = libraryModel.shelves.get(m.route.param(\"shelfId\"))\n        let journal = shelf?.journals.get(parseInt(m.route.param(\"journalId\")))\n\n        return m(\"#shelf\", [\n            m(breadcrumbComponent),\n            m(googleComponent),\n            m(\"span\", `Shelf: ${shelf?.title}, Journal: ${journal?.title}`)\n        ])\n    }\n\n    return {\n        view: view\n    }\n\n}\n"],"sourceRoot":""}