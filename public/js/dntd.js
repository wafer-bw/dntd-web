!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(8)),n(r(9)),n(r(10)),n(r(11))},function(e,t){e.exports=m},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(15),i=r(6);t.serviceWorkerModel=new i.ServiceWorkerModel,t.googleModel=new i.GoogleModel,t.syncerModel=new i.SyncerModel,t.libraryModel=new i.LibraryModel,t.urlModel=new i.UrlModel;const l=document.getElementById("root");null!==l&&o.default.route(l,"/",{"/":s.signinView,"/signin":s.signinView,"/library":s.libraryView,"/library/:shelfId":s.shelfView,"/library/:shelfId/:journalId":s.journalView})},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(18)),n(r(19)),n(r(20)),n(r(21)),n(r(24)),n(r(26))},,,function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(27)),n(r(28)),n(r(29)),n(r(30)),n(r(31)),n(r(32)),n(r(33)),n(r(34)),n(r(35))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(17)),n(r(36)),n(r(37)),n(r(38)),n(r(39)),n(r(40))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);class o extends Error{constructor(e,t,r,o){super(e),this.friendlyMsg=t,this.needsReAuth=r,this.payload={pause:void 0===o||o,error:this,friendlyMsg:this.friendlyMsg,type:n.SyncerPayloadType.ERROR}}}t.SyncerError=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.AND=1]="AND",e[e.OR=2]="OR"}(t.SearchType||(t.SearchType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OFF="0",e.WORKING="1",e.FAIL_GET_SPREADSHEET_SHEETS="2",e.FAIL_GET_RANGE="3",e.FAIL_UPDATE_RANGE="4",e.FAIL_DELETE_ROW="5",e.RETURN_ROWS="6",e.DEMO="7"}(t.TestMode||(t.TestMode={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.AUTH_UPDATE=0]="AUTH_UPDATE",e[e.DELETE_ROW=1]="DELETE_ROW",e[e.UPDATE_ROW=2]="UPDATE_ROW",e[e.GET_ROWS=3]="GET_ROWS",e[e.GET_SHEETS=4]="GET_SHEETS",e[e.TEST_MODE_UPDATE=5]="TEST_MODE_UPDATE",e[e.UNPAUSE=6]="UNPAUSE",e[e.GET_SPREADSHEET=7]="GET_SPREADSHEET",e[e.EXTEND_SHEET=8]="EXTEND_SHEET",e[e.CREATE_ROW=9]="CREATE_ROW",e[e.MOVE_ROW=10]="MOVE_ROW",e[e.ERROR=11]="ERROR",e[e.TOKEN_REQUEST=12]="TOKEN_REQUEST",e[e.SYNC_STATE=13]="SYNC_STATE"}(t.SyncerPayloadType||(t.SyncerPayloadType={})),function(e){e[e.SYNCER_STATE=0]="SYNCER_STATE",e[e.ERROR=1]="ERROR",e[e.REAUTH=2]="REAUTH"}(t.SyncerResponseType||(t.SyncerResponseType={})),function(e){e.PAUSED="cloud_off",e.UPLOADING="cloud_upload",e.DOWNLOADING="cloud_download",e.SYNCED="cloud_done"}(t.SyncerState||(t.SyncerState={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(25))},,,function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(16)),n(r(41)),n(r(42)),n(r(43))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(7);t.shelfView=function(){return{view:function(){return o.default("#shelf",[o.default(s.breadcrumbComponent),o.default(s.googleComponent),o.default(s.syncStateComponent),o.default(s.journalsComponent)])}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2),i=r(3);t.googleComponent=function(){return{view:function(){return o.default("#googleApi",[void 0===s.googleModel.isSignedIn||s.googleModel.isSignedIn?null:o.default(".preamble","PREAMBLE MSG"),s.googleModel.isSignedIn?o.default("button",{onclick:()=>i.googleController.signOut(),class:"authButton"},"Sign Out"):o.default("button",{onclick:()=>i.googleController.signIn(),class:"authButton"},"Sign In"),o.default("script",{async:!0,defer:!0,src:s.googleModel.src,onload:()=>{s.googleModel.isSignedIn||i.googleController.initGapi()}})])}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2);t.urlController={getBreadcrumbTrail:function(){var e,t,r;let n=[],i=s.urlModel.hash.split("/").filter(e=>"#"!==e&&""!==e),l=void 0;for(let a=0;a<i.length;a++){let u=i[a],c="#/"+i.slice(0,a+1).join("/");1===a?(l=u,u=(null===(e=s.libraryModel.shelves.get(u))||void 0===e?void 0:e.title)||u):2===a&&void 0!==l&&(u=(null===(r=null===(t=s.libraryModel.shelves.get(l))||void 0===t?void 0:t.journals.get(parseInt(u)))||void 0===r?void 0:r.title)||u),0!==a&&n.push(o.default("span"," / ")),a===i.length-1?n.push(o.default("span",""+u)):n.push(o.default("a",{href:c},""+u))}return n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textController={escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.caretController={getCaretPosition:function(e){var t=window.getSelection(),r=[0,0];if(t.anchorNode==e)r=[t.anchorNode.innerText.length,t.extentNode.innerText.length];else{var n=[t.anchorNode,t.extentNode];if(!e.contains(t.anchorNode)||!e.contains(t.extentNode))return;var o,s=[0,0];!function e(t,r){var n=r(t);for(t=t.firstChild;!1!==n&&t;t=t.nextSibling)n=e(t,r);return}(e,(function(e){for(o=0;o<2;o++)if(e==n[o]&&(s[o]=1,s[0==o?1:0]))return;if(e.textContent&&!e.firstChild)for(o=0;o<2;o++)s[o]||(r[o]+=e.textContent.length)})),r[0]+=t.anchorOffset,r[1]+=t.extentOffset}if(r[0]<=r[1])return r;return[r[1],r[0]]},setCaretPosition:function e(t,r){if(null!==t&&null!==r){for(var n of t.childNodes)if(3==n.nodeType){if(n.length>=r){let e=document.createRange(),t=window.getSelection();return e.setStart(n,r),e.collapse(!0),t.removeAllRanges(),t.addRange(e),-1}r-=n.length}else if(-1==(r=e(n,r)))return-1;return r}}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(r(1)),i=r(22),l=r(0),a=r(2),u=r(3);function c(e){return n(this,void 0,void 0,(function*(){a.googleModel.isSignedIn=e,a.googleModel.isSignedIn?(a.googleModel.user=a.googleModel.gapi_.auth2.getAuthInstance().currentUser.get(),u.syncerController.updateAuth(a.googleModel.token),u.libraryController.loadShelves()):u.libraryController.removeShelves(),s.default.redraw()}))}t.googleController={signIn:function(){a.googleModel.gapi_.auth2.getAuthInstance().signIn()},signOut:function(){a.googleModel.gapi_.auth2.getAuthInstance().signOut()},initGapi:function(){let e=a.urlModel.testMode===l.TestMode.OFF?gapi:new i.MockGapi;a.googleModel.gapi_=e,a.googleModel.gapi_.load("auth2",()=>{a.googleModel.gapi_.auth2.init({scope:a.googleModel.scope,client_id:a.googleModel.clientId}).then(()=>{a.googleModel.gapi_.auth2.getAuthInstance().isSignedIn.listen(c),c(a.googleModel.gapi_.auth2.getAuthInstance().isSignedIn.get())})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(23))},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.MockGapi=class{constructor(){this.auth2=new o}load(e,t){t()}};class o{getAuthInstance(){return new l}init(e){return n(this,void 0,void 0,(function*(){}))}}class s{get(){return new i}}class i{getAuthResponse(){return{expires_in:9999,access_token:"faketoken"}}reloadAuthResponse(){return n(this,void 0,void 0,(function*(){return{expires_in:9999,access_token:"faketoken"}}))}}t.MockGoogleUser=i;class l{constructor(){this.isSignedIn=new a,this.currentUser=new s}signOut(){}signIn(){}}class a{constructor(){this.listen=e=>{},this.get=()=>!0}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(r(1)),i=r(12),l=r(2),a=r(0),u=new Worker("./js/syncWebWorker.js");function c(e){if(void 0!==e)return l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.AUTH_UPDATE,token:e},u)}u.onmessage=e=>function(e){let{id:t,payload:r,error:n}=e.data;if(null!==t&&l.syncerModel.requests.has(t))l.syncerModel.requests.get(t)({payload:r,error:n}),l.syncerModel.requests.delete(t);else switch(r.type){case a.SyncerPayloadType.SYNC_STATE:l.syncerModel.state=r.state,s.default.redraw();break;case a.SyncerPayloadType.ERROR:new i.FriendlyError(r.error.message,r.friendlyMsg);break;case a.SyncerPayloadType.TOKEN_REQUEST:c(l.googleModel.token)}}(e),t.syncerController={unpause:function(){return n(this,void 0,void 0,(function*(){return yield l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.UNPAUSE},u)}))},getRows:function(e,t,r){return l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.GET_ROWS,spreadsheetId:e,sheetTitle:r,sheetId:t,rows:[]},u)},deleteRow:function(e,t,r){return n(this,void 0,void 0,(function*(){return yield l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.DELETE_ROW,spreadsheetId:t,sheetId:r,idx:e},u)}))},updateRow:function(e,t,r,o,s){return n(this,void 0,void 0,(function*(){return yield l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.UPDATE_ROW,spreadsheetId:t,sheetTitle:o,sheetId:r,content:s,idx:e},u)}))},getSheets:function(e){return l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.GET_SHEETS,spreadsheetId:e,sheets:[]},u)},updateAuth:c,updateTestMode:function(e){return n(this,void 0,void 0,(function*(){return yield l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.TEST_MODE_UPDATE,testMode:e},u)}))},getSpreadsheet:function(e){return l.syncerModel.pushSyncerTask({type:a.SyncerPayloadType.GET_SPREADSHEET,spreadsheetId:e,spreadsheet:void 0},u)}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1));class s extends Error{constructor(e,t){super(e),this.friendlyMsg=t,console.warn(e),o.default.redraw()}}t.FriendlyError=s},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2),i=r(6),l=r(12),a=r(3),u=new i.ShelfFactory,c=/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/g;function d(e,t){console.log("LOAD"),void 0===t&&(t=Array.from(s.libraryModel.shelves.keys())),e&&(t.forEach(e=>s.libraryModel.shelves.set(e,void 0)),o.default.redraw()),t.filter(e=>!s.libraryModel.shelves.get(e)).forEach(e=>a.syncerController.getSpreadsheet(e).then(t=>{let r=u.createShelf(e,t.spreadsheet);s.libraryModel.shelves.set(r.id,r)}).catch(t=>{new l.FriendlyError(t.error.message,t.friendlyMsg);let r=u.createShelf(e,void 0,t.friendlyMsg);s.libraryModel.shelves.set(e,r)}).finally(()=>{o.default.redraw()}))}function f(e){let t=[];return e&&Array.from(e.matchAll(c)).forEach(e=>t.push(e[1])),t}t.libraryController={addShelves:function(e){let t=f(e);t=t.filter(e=>!s.libraryModel.shelves.has(e)),t.forEach(e=>s.libraryModel.shelves.set(e,void 0)),s.libraryModel.shelfIds=Array.from(s.libraryModel.shelves.keys()),d(!1,t)},loadShelves:d,removeShelves:function(e){void 0===e&&(e=Array.from(s.libraryModel.shelves.keys()));(e=e.filter(e=>s.libraryModel.shelves.has(e))).forEach(e=>s.libraryModel.shelves.delete(e)),s.libraryModel.shelfIds=Array.from(s.libraryModel.shelves.keys())},getSpreadsheetIdsFromUrls:f}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);t.UrlModel=class{get hash(){return new URL(window.location.href).hash}get testMode(){let e=new URL(window.location.href);if("#!demo"===e.hash)return n.TestMode.DEMO;let t=e.searchParams.get("test");return null!==t&&this.instanceOfTestMode(t)?t:n.TestMode.OFF}instanceOfTestMode(e){return Object.values(n.TestMode).includes(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3);t.TagModel=class{constructor(e,t,r,n,o){this.frq=1,this.raw=e,this.flag=t,this.key=r,this.separator=void 0!==n?n:null,this.val=void 0!==o?o:null,this.clean=this.cleanTagString(this.raw),this.cleanKey=this.cleanTagString(this.key),this.cleanVal=null!==this.val?this.cleanTagString(this.val):null}renderKey(){return"<span onclick=\"tagOnClick(event, '"+this.flag+this.cleanKey+(this.separator?this.separator:"")+'\')" class="'+(this.separator?"tagKey":null===this.val?"simpleTag":"roundTagVal")+'">'+this.flag+this.key+"</span>"}renderVal(e){var t;return"<span onclick=\"tagOnClick(event, '"+this.flag+this.cleanKey+this.separator+(null===(t=this.cleanVal)||void 0===t?void 0:t.replace(/'/,"\\'"))+'\')" class="'+(e?"roundTagVal":"tagVal")+'">'+(e?"":this.separator)+(this.val||"")+"</span>"}render(e){return this.separator?e?this.renderVal(e):this.renderKey()+this.renderVal(e):this.renderKey()}cleanTagString(e){return e=(e=(e=n.textController.escapeHtml(e)).endsWith("'s")?e.substring(0,e.length-2):e).toLowerCase()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),o=r(3),s=/(\@)([\w-']+)+(:)?([\w-'\*]+)?/g;t.EntryModel=class{constructor(e,t){this.tags=new Map,this.hovered=!1,this.focused=!1,this.clean="",this.tokens=[],this.rendered="",this.savedClean="",this.tagMatches=[],this.readableRendered="",this.rawText="",this.savedText="",this.raw=e||"",this.saved=void 0!==t?t:this.raw}get saved(){return this.savedText}set saved(e){this.savedText=e,this.savedClean=e.toLowerCase(),this.tags=this.getTags(this.tagMatches)}get raw(){return this.rawText}set raw(e){this.rawText=e,this.clean=this.raw.toLowerCase();let t=o.textController.escapeHtml(this.rawText);this.tokens=this.getTokens(this.clean),this.tagMatches=this.getTagMatches(t),this.rendered=this.render(t,this.tagMatches),this.readableRendered=this.render(t,this.tagMatches,!0)}render(e,t,r){for(let{tag:n,match:o}of t){let t=e.split("");t.splice(o.index,o[0].length,n.render(r)),e=t.join("")}return e}getTags(e){let t=new Map;for(let{tag:r}of e)t.has(r.clean)?t.get(r.clean).frq+=1:t.set(r.clean,r);return t}getTagMatches(e){let t=[],r=e.matchAll(s);for(let e of r){let r=new n.TagModel(e[0],e[1],e[2],e[3],e[4]);t.push({tag:r,match:e})}return t.sort((e,t)=>e.match.index>t.match.index?-1:1),t}getTokens(e){return e.split(" ").filter(e=>void 0!==e&&""!==e.trim()&&"-"!==e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6);t.ShelfFactory=class{createShelf(e,t,r){if(void 0!==t&&void 0!==t.spreadsheetId&&void 0!==t.properties&&void 0!==t.properties.title&&void 0!==t.sheets){let e=this.getJournals(t.spreadsheetId,t.sheets);return new o(t.spreadsheetId,t.properties.title,e)}return new o(e,void 0,void 0,r)}getJournals(e,t){let r=[];return t.forEach(t=>{if(void 0!==t.properties&&void 0!==t.properties.title&&void 0!==t.properties.sheetId){let o=new n.JournalModel(t.properties.sheetId,e,t.properties.title);if(void 0===o)return;r.push(o)}}),r}};class o{constructor(e,t,r,n){this.journals=new Map,this.id=e,this.error=n,this.title=t,void 0!==r&&this.addJournals(r)}addJournals(e){e.filter(e=>!this.journals.has(e.id)).forEach(e=>this.journals.set(e.id,e))}}t.ShelfModel=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);t.SyncerModel=class{constructor(){this.requestsCounter=0,this.requests=new Map,this.state=n.SyncerState.SYNCED}pushSyncerTask(e,t){let r="payload-"+this.requestsCounter++;return new Promise((n,o)=>{this.requests.set(r,({payload:e,error:t})=>{t?o(t):n(e)}),t.postMessage({id:r,payload:e})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GoogleModel=class{constructor(e){this.isSignedIn=e,this.src="https://apis.google.com/js/api.js",this.scope=["https://www.googleapis.com/auth/spreadsheets"].join(" "),this.clientId="893904323330-moo1k9s19qp40kr747pftdo29ejdef0o.apps.googleusercontent.com"}get token(){if(!this.user)return;return this.user.getAuthResponse().access_token}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6);t.JournalModel=class{constructor(e,t,r){this.entries=[],this.id=e,this.title=r,this.tags=new Map,this.shelfId=t}buildTags(){let e=new Map;for(let t of Array.from(this.entries.values()).reverse())for(let[r,o]of t.tags)e.has(r)?e.get(r).frq+=o.frq:e.set(r,new n.TagModel(o.raw,o.flag,o.key,o.separator,o.val));return e}addEntry(e,t){this.entries.splice(e,0,new n.EntryModel(t)),this.tags=this.buildTags()}updateEntry(e,t){let r=this.entries[e];r.saved!==t&&(r.saved=t,this.tags=this.buildTags())}deleteEntry(e){this.entries.splice(e,1)[0],this.tags=this.buildTags()}moveEntry(e,t){let r=this.entries[e];this.entries.splice(e,1),this.entries.splice(t,0,r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LibraryModel=class{constructor(){this.shelves=new Map,this.shelfIds.forEach(e=>this.shelves.set(e,void 0))}set shelfIds(e){localStorage.setItem("spreadsheetIds",e.join(","))}get shelfIds(){let e=localStorage.getItem("spreadsheetIds");return null===e?[]:e.split(",")}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=r(12);t.ServiceWorkerModel=class{constructor(){if(!("serviceWorker"in navigator))throw new o.FriendlyError("serviceWorker not supported","Your browser is not supported.");window.addEventListener("load",()=>n(this,void 0,void 0,(function*(){yield navigator.serviceWorker.register("../serviceWorker.js")})))}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2),i=r(3);t.shelvesComponent=function(){function e(e){return o.default("button",{class:"del",onclick:()=>i.libraryController.removeShelves([e])},"del")}function t(e){return o.default("button",{onclick:()=>i.libraryController.loadShelves(!0,[e])},"retry")}return{view:function(){let r=Array.from(s.libraryModel.shelves.entries());return o.default("#shelvesList",r.map(([r,n])=>function(r,n){return void 0===n?o.default("li",[e(r),o.default("span",r)]):void 0!==n.error?o.default("li",[e(r),o.default("span",`${r} ${n.error}`),t(r)]):o.default("li",[e(r),o.default("a",{href:"#/library/"+r},n.title)])}(r,n)))}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2);t.journalsComponent=function(){return{view:function(){return o.default("#journals",function(){let e=s.libraryModel.shelves.get(o.default.route.param("shelfId"));if(void 0===e)return;return Array.from(e.journals.values()).map(e=>{let t=`#/library/${e.shelfId}/${e.id}`;return o.default("li",o.default("a",{href:t},e.title))})}())}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2),i=r(0),l=r(3);t.syncStateComponent=function(){function e(){let e="",t="syncState "+n();switch(s.syncerModel.state){case i.SyncerState.DOWNLOADING:e="Downloading journal data from drive...";break;case i.SyncerState.PAUSED:e="Warning! - Syncing is paused.";break;case i.SyncerState.SYNCED:e="All changes saved.";break;case i.SyncerState.UPLOADING:e="Uploading changes to drive..."}return o.default("span",{id:"syncStateText",class:t},e)}function t(){let e="material-icons material-icons-outlined syncState "+n();return o.default("i",{id:"syncStateIcon",class:e},s.syncerModel.state)}function r(){if(s.syncerModel.state===i.SyncerState.PAUSED)return o.default("button",{id:"unpauseSync",class:"syncState",onclick:()=>l.syncerController.unpause()},"Unpause Syncing")}function n(){switch(s.syncerModel.state){case i.SyncerState.PAUSED:return"error";case i.SyncerState.SYNCED:return"okay";default:return"warn"}}return{view:function(){return o.default("#status",o.default("span",o.default("span",[t(),e(),r()])))}}}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function i(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(r(1)),i=r(3);t.addShelvesComponent=function(){let e="",t=!1;function r(){return s.default("button",{id:"addShelvesButton",onclick:()=>n(this,void 0,void 0,(function*(){t&&i.libraryController.addShelves(e),e="",t=!t}))},t?" âœ“ ":"+/-")}function o(){return t?s.default("textarea",{id:"addShelvesText",placeholder:"Enter list of Google Sheets Spreadsheet URLs here",oninput:t=>e=t.target.value}):null}return{view:function(){return s.default("#addShelves",[r(),o()])}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(3);t.breadcrumbComponent=function(){return{view:function(){return o.default("#breadcrumb",s.urlController.getBreadcrumbTrail())}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2),i=r(7);t.signinView=function(){return{view:function(){return o.default("#auth",[o.default(i.googleComponent)])},onupdate:function(){s.googleModel.isSignedIn&&(window.location.hash="/library")}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(7);t.libraryView=function(){return{view:function(){return o.default("#library",[o.default(s.googleComponent),o.default(s.syncStateComponent),o.default(s.addShelvesComponent),o.default(s.shelvesComponent)])}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(1)),s=r(2),i=r(7);t.journalView=function(){return{view:function(){let e=s.libraryModel.shelves.get(o.default.route.param("shelfId")),t=null==e?void 0:e.journals.get(parseInt(o.default.route.param("journalId")));return o.default("#shelf",[o.default(i.breadcrumbComponent),o.default(i.googleComponent),o.default("span",`Shelf: ${null==e?void 0:e.title}, Journal: ${null==t?void 0:t.title}`)])}}}}]);
//# sourceMappingURL=dntd.js.map